(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,73843,e=>{"use strict";var t=e.i(47167),r=e.i(76009);let a=t.default.env.NEXT_PUBLIC_API_URL||"http://localhost:8000",i=async()=>{let e=r.auth.currentUser;if(!e)throw Error("User not authenticated");return await e.getIdToken()},n=e=>{if(!e)throw Error("Missing Company ID. Please select a company first.");if("null"===e||"undefined"===e)throw Error("Invalid Company ID format. Session may be corrupted.");return e},s=async e=>{try{let t=n(e),r=await i(),s=await fetch(`${a}/api/v1/integrations/`,{headers:{Authorization:`Bearer ${r}`,"X-Company-ID":t}});if(!s.ok){let e=await s.json().catch(()=>({}));throw Error(e.detail||`Failed to fetch integrations: ${s.status}`)}return s.json()}catch(t){throw console.error("[API:listIntegrations] Failure:",{url:`${a}/api/v1/integrations/`,companyId:e,error:t.message}),t}},o=async(e,t)=>{try{let r=n(e),s=await i(),o=await fetch(`${a}/api/v1/integrations/${t}`,{headers:{Authorization:`Bearer ${s}`,"X-Company-ID":r}});if(!o.ok){let e=await o.json().catch(()=>({}));throw Error(e.detail||`Failed to fetch integration: ${o.status}`)}return o.json()}catch(r){throw console.error("[API:getIntegration] Failure:",{id:t,companyId:e,error:r.message}),r}},l=async(e,t)=>{let r=await i(),n=await fetch(`${a}/api/v1/integrations/connect/${t}`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"X-Company-ID":e}});if(!n.ok)throw Error("Failed to connect integration");return n.json()},c=async(e,t,r=!1)=>{let n=await i(),s=new URL(`${a}/api/v1/integrations/sync/${t}`);r&&s.searchParams.append("delta","true");let o=await fetch(s.toString(),{method:"POST",headers:{Authorization:`Bearer ${n}`,"X-Company-ID":e}});if(!o.ok)throw Error("Failed to trigger sync");return o.json()},d=async(e,t)=>{let r=await i(),n=await fetch(`${a}/api/v1/integrations/disconnect/${t}`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"X-Company-ID":e}});if(!n.ok)throw Error("Failed to disconnect integration");return n.json()},u=async(e,t,r)=>{let n=await i(),s=await fetch(`${a}/api/v1/integrations/add-manual-source`,{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json","X-Company-ID":e},body:JSON.stringify({slug:t,category:r})});if(!s.ok)throw Error("Failed to add manual source");return s.json()},h=async(e,t,r=30)=>{let n=await i(),s=await fetch(`${a}/api/v1/analytics/daily/${t}?days=${r}`,{headers:{Authorization:`Bearer ${n}`,"X-Company-ID":e}});if(!s.ok)throw Error("Failed to fetch daily metrics");return s.json()},f=async(e,t)=>{let r=await i(),n=await fetch(`${a}/api/v1/analytics/overview/${t}`,{headers:{Authorization:`Bearer ${r}`,"X-Company-ID":e}});if(!n.ok)throw Error("Failed to fetch overview metrics");return n.json()},m=async(e,t)=>{let r=await i(),n=await fetch(`${a}/api/v1/integrations/shopify/integrations/${t}/reconcile`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"X-Company-ID":e}});if(!n.ok)throw Error((await n.json().catch(()=>({detail:"Failed to trigger reconciliation"}))).detail||"Failed to trigger reconciliation")},p=async(e,t)=>{let r=await i(),n=await fetch(`${a}/api/v1/integrations/verify-integrity/${t}`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"X-Company-ID":e}});if(!n.ok)throw Error((await n.json().catch(()=>({detail:"Failed to verify integrity"}))).detail||"Failed to verify integrity");return n.json()};e.s(["addManualSource",0,u,"connectIntegration",0,l,"disconnectIntegration",0,d,"getIntegration",0,o,"getIntegrationDailyMetrics",0,h,"getIntegrationOverview",0,f,"listIntegrations",0,s,"syncIntegration",0,c,"triggerShopifyReconciliation",0,m,"verifyIntegrationIntegrity",0,p])},23945,e=>{"use strict";let t=(0,e.i(75254).default)("store",[["path",{d:"M15 21v-5a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v5",key:"slp6dd"}],["path",{d:"M17.774 10.31a1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.451 0 1.12 1.12 0 0 0-1.548 0 2.5 2.5 0 0 1-3.452 0 1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.77-3.248l2.889-4.184A2 2 0 0 1 7 2h10a2 2 0 0 1 1.653.873l2.895 4.192a2.5 2.5 0 0 1-3.774 3.244",key:"o0xfot"}],["path",{d:"M4 10.95V19a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8.05",key:"wn3emo"}]]);e.s(["Store",()=>t],23945)},83086,76144,e=>{"use strict";let t=(0,e.i(75254).default)("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]);e.s(["default",()=>t],76144),e.s(["Sparkles",()=>t],83086)},23750,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(47163);let i=r.forwardRef(({className:e,type:r,...i},n)=>(0,t.jsx)("input",{type:r,className:(0,a.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:n,...i}));i.displayName="Input",e.s(["Input",()=>i])},58041,e=>{"use strict";let t=(0,e.i(75254).default)("database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);e.s(["Database",()=>t],58041)},95468,e=>{"use strict";let t=(0,e.i(75254).default)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);e.s(["CheckCircle2",()=>t],95468)},87316,61277,e=>{"use strict";let t=(0,e.i(75254).default)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);e.s(["default",()=>t],61277),e.s(["Calendar",()=>t],87316)},31278,e=>{"use strict";let t=(0,e.i(75254).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],31278)},75254,e=>{"use strict";var t=e.i(71645);let r=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},a=(...e)=>e.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim();var i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=(0,t.forwardRef)(({color:e="currentColor",size:r=24,strokeWidth:n=2,absoluteStrokeWidth:s,className:o="",children:l,iconNode:c,...d},u)=>(0,t.createElement)("svg",{ref:u,...i,width:r,height:r,stroke:e,strokeWidth:s?24*Number(n)/Number(r):n,className:a("lucide",o),...!l&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(d)&&{"aria-hidden":"true"},...d},[...c.map(([e,r])=>(0,t.createElement)(e,r)),...Array.isArray(l)?l:[l]])),s=(e,i)=>{let s=(0,t.forwardRef)(({className:s,...o},l)=>(0,t.createElement)(n,{ref:l,iconNode:i,className:a(`lucide-${r(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,s),...o}));return s.displayName=r(e),s};e.s(["default",()=>s],75254)},67881,91918,25913,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(20783),i=Symbol.for("react.lazy"),n=r[" use ".trim().toString()];function s(e){var t;return null!=e&&"object"==typeof e&&"$$typeof"in e&&e.$$typeof===i&&"_payload"in e&&"object"==typeof(t=e._payload)&&null!==t&&"then"in t}function o(e){var i;let o,l=(i=e,(o=r.forwardRef((e,t)=>{let{children:i,...o}=e;if(s(i)&&"function"==typeof n&&(i=n(i._payload)),r.isValidElement(i)){var l;let e,n,s=(l=i,(n=(e=Object.getOwnPropertyDescriptor(l.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?l.ref:(n=(e=Object.getOwnPropertyDescriptor(l,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?l.props.ref:l.props.ref||l.ref),c=function(e,t){let r={...t};for(let a in t){let i=e[a],n=t[a];/^on[A-Z]/.test(a)?i&&n?r[a]=(...e)=>{let t=n(...e);return i(...e),t}:i&&(r[a]=i):"style"===a?r[a]={...i,...n}:"className"===a&&(r[a]=[i,n].filter(Boolean).join(" "))}return{...e,...r}}(o,i.props);return i.type!==r.Fragment&&(c.ref=t?(0,a.composeRefs)(t,s):s),r.cloneElement(i,c)}return r.Children.count(i)>1?r.Children.only(null):null})).displayName=`${i}.SlotClone`,o),c=r.forwardRef((e,a)=>{let{children:i,...o}=e;s(i)&&"function"==typeof n&&(i=n(i._payload));let c=r.Children.toArray(i),u=c.find(d);if(u){let e=u.props.children,i=c.map(t=>t!==u?t:r.Children.count(e)>1?r.Children.only(null):r.isValidElement(e)?e.props.children:null);return(0,t.jsx)(l,{...o,ref:a,children:r.isValidElement(e)?r.cloneElement(e,void 0,i):null})}return(0,t.jsx)(l,{...o,ref:a,children:i})});return c.displayName=`${e}.Slot`,c}var l=o("Slot"),c=Symbol("radix.slottable");function d(e){return r.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===c}e.s(["Slot",()=>l,"createSlot",()=>o],91918);var u=e.i(7670);let h=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,f=u.clsx,m=(e,t)=>r=>{var a;if((null==t?void 0:t.variants)==null)return f(e,null==r?void 0:r.class,null==r?void 0:r.className);let{variants:i,defaultVariants:n}=t,s=Object.keys(i).map(e=>{let t=null==r?void 0:r[e],a=null==n?void 0:n[e];if(null===t)return null;let s=h(t)||h(a);return i[e][s]}),o=r&&Object.entries(r).reduce((e,t)=>{let[r,a]=t;return void 0===a||(e[r]=a),e},{});return f(e,s,null==t||null==(a=t.compoundVariants)?void 0:a.reduce((e,t)=>{let{class:r,className:a,...i}=t;return Object.entries(i).every(e=>{let[t,r]=e;return Array.isArray(r)?r.includes({...n,...o}[t]):({...n,...o})[t]===r})?[...e,r,a]:e},[]),null==r?void 0:r.class,null==r?void 0:r.className)};e.s(["cva",0,m],25913);var p=e.i(47163);let y=m("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 shadow-sm",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90 shadow-sm",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground transition-all active:scale-[0.98]",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),x=r.forwardRef(({className:e,variant:r,size:a,asChild:i=!1,...n},s)=>(0,t.jsx)(i?l:"button",{className:(0,p.cn)(y({variant:r,size:a,className:e})),ref:s,...n}));x.displayName="Button",e.s(["Button",()=>x,"buttonVariants",()=>y],67881)},88653,e=>{"use strict";e.i(47167);var t=e.i(43476),r=e.i(71645),a=e.i(31178),i=e.i(47414),n=e.i(74008),s=e.i(21476),o=e.i(72846),l=r,c=e.i(37806);function d(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}class u extends l.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=t.offsetParent,r=(0,o.isHTMLElement)(e)&&e.offsetWidth||0,a=this.props.sizeRef.current;a.height=t.offsetHeight||0,a.width=t.offsetWidth||0,a.top=t.offsetTop,a.left=t.offsetLeft,a.right=r-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function h({children:e,isPresent:a,anchorX:i,root:n}){let s=(0,l.useId)(),o=(0,l.useRef)(null),h=(0,l.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:f}=(0,l.useContext)(c.MotionConfigContext),m=function(...e){return r.useCallback(function(...e){return t=>{let r=!1,a=e.map(e=>{let a=d(e,t);return r||"function"!=typeof a||(r=!0),a});if(r)return()=>{for(let t=0;t<a.length;t++){let r=a[t];"function"==typeof r?r():d(e[t],null)}}}}(...e),e)}(o,e?.ref);return(0,l.useInsertionEffect)(()=>{let{width:e,height:t,top:r,left:l,right:c}=h.current;if(a||!o.current||!e||!t)return;let d="left"===i?`left: ${l}`:`right: ${c}`;o.current.dataset.motionPopId=s;let u=document.createElement("style");f&&(u.nonce=f);let m=n??document.head;return m.appendChild(u),u.sheet&&u.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${e}px !important;
            height: ${t}px !important;
            ${d}px !important;
            top: ${r}px !important;
          }
        `),()=>{m.contains(u)&&m.removeChild(u)}},[a]),(0,t.jsx)(u,{isPresent:a,childRef:o,sizeRef:h,children:l.cloneElement(e,{ref:m})})}let f=({children:e,initial:a,isPresent:n,onExitComplete:o,custom:l,presenceAffectsLayout:c,mode:d,anchorX:u,root:f})=>{let p=(0,i.useConstant)(m),y=(0,r.useId)(),x=!0,g=(0,r.useMemo)(()=>(x=!1,{id:y,initial:a,isPresent:n,custom:l,onExitComplete:e=>{for(let t of(p.set(e,!0),p.values()))if(!t)return;o&&o()},register:e=>(p.set(e,!1),()=>p.delete(e))}),[n,p,o]);return c&&x&&(g={...g}),(0,r.useMemo)(()=>{p.forEach((e,t)=>p.set(t,!1))},[n]),r.useEffect(()=>{n||p.size||!o||o()},[n]),"popLayout"===d&&(e=(0,t.jsx)(h,{isPresent:n,anchorX:u,root:f,children:e})),(0,t.jsx)(s.PresenceContext.Provider,{value:g,children:e})};function m(){return new Map}var p=e.i(64978);let y=e=>e.key||"";function x(e){let t=[];return r.Children.forEach(e,e=>{(0,r.isValidElement)(e)&&t.push(e)}),t}let g=({children:e,custom:s,initial:o=!0,onExitComplete:l,presenceAffectsLayout:c=!0,mode:d="sync",propagate:u=!1,anchorX:h="left",root:m})=>{let[g,v]=(0,p.usePresence)(u),w=(0,r.useMemo)(()=>x(e),[e]),b=u&&!g?[]:w.map(y),j=(0,r.useRef)(!0),k=(0,r.useRef)(w),N=(0,i.useConstant)(()=>new Map),[C,$]=(0,r.useState)(w),[z,I]=(0,r.useState)(w);(0,n.useIsomorphicLayoutEffect)(()=>{j.current=!1,k.current=w;for(let e=0;e<z.length;e++){let t=y(z[e]);b.includes(t)?N.delete(t):!0!==N.get(t)&&N.set(t,!1)}},[z,b.length,b.join("-")]);let S=[];if(w!==C){let e=[...w];for(let t=0;t<z.length;t++){let r=z[t],a=y(r);b.includes(a)||(e.splice(t,0,r),S.push(r))}return"wait"===d&&S.length&&(e=S),I(x(e)),$(w),null}let{forceRender:E}=(0,r.useContext)(a.LayoutGroupContext);return(0,t.jsx)(t.Fragment,{children:z.map(e=>{let r=y(e),a=(!u||!!g)&&(w===z||b.includes(r));return(0,t.jsx)(f,{isPresent:a,initial:(!j.current||!!o)&&void 0,custom:s,presenceAffectsLayout:c,mode:d,root:m,onExitComplete:a?void 0:()=>{if(!N.has(r))return;N.set(r,!0);let e=!0;N.forEach(t=>{t||(e=!1)}),e&&(E?.(),I(k.current),u&&v?.(),l&&l())},anchorX:h,children:e},r)})})};e.s(["AnimatePresence",()=>g],88653)},54858,e=>{"use strict";var t=e.i(47167),r=e.i(76009);let a=t.default.env.NEXT_PUBLIC_API_URL?`${t.default.env.NEXT_PUBLIC_API_URL}/api/v1`:"/api/v1";class i extends Error{status;data;constructor(e,t,r){super(e),this.name="ApiError",this.status=t,this.data=r}}e.s(["api",0,{async request(e,t={}){let n=r.auth.currentUser,s=n?await n.getIdToken():null,o=localStorage.getItem("unclutr_company_id"),l={"Content-Type":"application/json",...s?{Authorization:`Bearer ${s}`}:{},...o?{"X-Company-ID":o}:{},...t.headers||{}};!o&&e.startsWith("/execution")&&console.warn(`DEBUG: API Request to ${e} missing X-Company-ID. LocalStorage 'unclutr_company_id' is:`,o);let c=`${a}${e}`,d=await fetch(c,{...t,cache:"no-store",headers:l});if(!d.ok){let e=await d.json().catch(()=>({detail:"Unknown error"}));throw console.error("DEBUG: API Error",{url:c,status:d.status,errorData:e}),new i(e.detail||d.statusText,d.status,e)}return d.json()},get(e,t){return this.request(e,{method:"GET",headers:t})},post(e,t={},r){return this.request(e,{method:"POST",body:JSON.stringify(t),headers:r})},patch(e,t={},r){return this.request(e,{method:"PATCH",body:JSON.stringify(t),headers:r})},put(e,t={},r){return this.request(e,{method:"PUT",body:JSON.stringify(t),headers:r})},delete(e,t){return this.request(e,{method:"DELETE",headers:t})}}])},10708,e=>{"use strict";var t=e.i(43476),r=e.i(71645);e.i(74080);var a=e.i(91918),i=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,i)=>{let n=(0,a.createSlot)(`Primitive.${i}`),s=r.forwardRef((e,r)=>{let{asChild:a,...s}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,t.jsx)(a?n:i,{...s,ref:r})});return s.displayName=`Primitive.${i}`,{...e,[i]:s}},{}),n=r.forwardRef((e,r)=>(0,t.jsx)(i.label,{...e,ref:r,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));n.displayName="Label";var s=e.i(25913),o=e.i(47163);let l=(0,s.cva)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=r.forwardRef(({className:e,...r},a)=>(0,t.jsx)(n,{ref:a,className:(0,o.cn)(l(),e),...r}));c.displayName=n.displayName,e.s(["Label",()=>c],10708)},27516,e=>{"use strict";let t=(0,e.i(75254).default)("history",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);e.s(["History",()=>t],27516)},24230,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(18566),i=e.i(46932),n=e.i(88653),s=e.i(23945),o=e.i(31278),l=e.i(87316),c=e.i(95468),d=e.i(83086),u=e.i(58041),h=e.i(27516),f=e.i(67881),m=e.i(23750),p=e.i(10708),y=e.i(38938),x=e.i(54858);let g=async(e,t)=>{try{return(await x.api.post("/integrations/shopify/auth/url",{shop_domain:e,company_id:t},{"X-Company-ID":t})).url}catch(e){if(console.error("Failed to generate auth URL:",e),e instanceof Error)throw Error(e.message||"Failed to generate auth URL");throw Error("Failed to generate auth URL")}},v=async(e,t,r=12)=>{try{return await x.api.post(`/integrations/shopify/sync/${e}`,{months:r},{"X-Company-ID":t})}catch(e){throw console.error("Failed to trigger sync:",e),e}};var w=e.i(73843),b=e.i(46696),j=e.i(47163);function k(){let e=(0,a.useRouter)(),x=(0,a.useSearchParams)(),{companyId:k}=(0,y.useAuth)(),[N,C]=(0,r.useState)(""),[$,z]=(0,r.useState)(!1),[I,S]=(0,r.useState)(null),[E,P]=(0,r.useState)(null),[A,R]=(0,r.useState)(!1),[L,D]=(0,r.useState)(null),[M,_]=(0,r.useState)(12);(0,r.useEffect)(()=>{let e=x.get("success"),t=x.get("shop");"true"===e&&t&&k&&(R(!0),C(t),B(t))},[x,k]);let B=async e=>{try{let t=(await (0,w.listIntegrations)(k)).find(t=>"shopify"===t.datasource.slug&&t.metadata_info?.shop===e);t&&D(t.id)}catch(e){console.error("Failed to find integration:",e)}},T=async()=>{if(!k)return void console.error("handleContinue: Missing companyId");z(!0),S(null);let e=N.trim().toLowerCase().replace(/^https?:\/\//,"").replace(/\/admin.*$/,"").replace(/\/$/,"");e.includes(".")||(e+=".myshopify.com"),console.log(`handleContinue: Validating domain ${e}`);try{console.log("handleContinue: Requesting Auth URL directly (Fast Path)...");let t=await g(e,k);console.log(`handleContinue: Redirecting to ${t}`),P(t),window.location.assign(t)}catch(e){console.error("handleContinue Error:",e),S(e.message||"Failed to validate store"),z(!1),b.toast.error("Connection Failed",{description:e.message})}},F=async()=>{if(L&&k){z(!0);try{await v(L,k,M),e.push(`/dashboard-new/integrations?success=true&shop=${N}&syncing=${L}`),b.toast.success("Import Started",{description:"Streaming your Shopify data now."})}catch(e){b.toast.error("Sync Failed",{description:"Wait a moment and try again."}),z(!1)}}};return(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-b from-zinc-50 to-white dark:from-zinc-950 dark:to-zinc-900 flex items-center justify-center p-6",children:(0,t.jsxs)(i.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full max-w-[460px] space-y-8",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between text-xs font-bold uppercase tracking-widest text-zinc-500",children:[(0,t.jsx)("span",{children:A?"Step 2 of 3: Configuration":"Step 1 of 3: Handshake"}),(0,t.jsx)("span",{children:A?"66%":"33%"})]}),(0,t.jsx)("div",{className:"h-1.5 bg-zinc-200 dark:bg-zinc-800 rounded-full overflow-hidden",children:(0,t.jsx)(i.motion.div,{initial:{width:"33%"},animate:{width:A?"66%":"33%"},className:"h-full bg-emerald-500 shadow-[0_0_8px_rgba(16,185,129,0.5)]"})})]}),(0,t.jsx)(n.AnimatePresence,{children:A?(0,t.jsxs)(i.motion.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"space-y-8",children:[(0,t.jsx)("div",{className:"flex justify-center scale-110",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"w-16 h-16 rounded-2xl bg-emerald-500 flex items-center justify-center shadow-xl shadow-emerald-500/30",children:(0,t.jsx)(c.CheckCircle2,{className:"w-9 h-9 text-white"})}),(0,t.jsx)(i.motion.div,{animate:{scale:[1,1.2,1],opacity:[.3,.6,.3]},transition:{repeat:1/0,duration:2},className:"absolute -inset-2 rounded-3xl border-2 border-emerald-500"})]})}),(0,t.jsxs)("div",{className:"text-center space-y-2",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold tracking-tight text-zinc-900 dark:text-zinc-100",children:"Handshake Verified"}),(0,t.jsxs)("p",{className:"text-sm text-zinc-500",children:["Connected to ",(0,t.jsx)("span",{className:"font-bold text-zinc-900 dark:text-zinc-200",children:N}),". Choose your import depth."]})]}),(0,t.jsx)("div",{className:"grid gap-3",children:[{label:"Last 3 Months",value:3,desc:"Fastest import, recent history"},{label:"Last 12 Months",value:12,desc:"Recommended for analysis",recommended:!0},{label:"All Time",value:0,desc:"Exhaustive historical backfill"}].map(e=>(0,t.jsxs)("button",{onClick:()=>_(e.value),className:(0,j.cn)("flex items-center justify-between p-4 rounded-2xl border-2 transition-all text-left group",M===e.value?"border-emerald-500 bg-emerald-50/10 shadow-lg shadow-emerald-500/5":"border-zinc-100 dark:border-zinc-800 hover:border-zinc-200 dark:hover:border-zinc-700 bg-white dark:bg-zinc-900/50"),children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("div",{className:(0,j.cn)("p-3 rounded-xl transition-colors",M===e.value?"bg-emerald-500 text-white":"bg-zinc-100 dark:bg-zinc-800 text-zinc-400 group-hover:text-zinc-500"),children:0===e.value?(0,t.jsx)(h.History,{className:"w-5 h-5"}):(0,t.jsx)(l.Calendar,{className:"w-5 h-5"})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"text-sm font-bold flex items-center gap-2",children:[e.label,e.recommended&&(0,t.jsx)("span",{className:"text-[10px] bg-emerald-500/10 text-emerald-600 px-2 py-0.5 rounded-full",children:"Recommended"})]}),(0,t.jsx)("div",{className:"text-xs text-zinc-500 mt-0.5",children:e.desc})]})]}),(0,t.jsx)("div",{className:(0,j.cn)("w-5 h-5 rounded-full border-2 flex items-center justify-center transition-all",M===e.value?"border-emerald-500 bg-emerald-500":"border-zinc-200 dark:border-zinc-700"),children:M===e.value&&(0,t.jsx)("div",{className:"w-2 h-2 rounded-full bg-white"})})]},e.value))}),(0,t.jsx)(f.Button,{onClick:F,disabled:$||!L,className:"h-16 w-full bg-emerald-600 hover:bg-emerald-700 text-white font-bold text-lg rounded-2xl shadow-xl shadow-emerald-500/20 transition-all hover:scale-[1.02] active:scale-95",children:$?(0,t.jsx)(o.Loader2,{className:"w-5 h-5 animate-spin mr-2"}):(0,t.jsxs)("span",{className:"flex items-center gap-2",children:[(0,t.jsx)(u.Database,{className:"w-5 h-5"}),"Begin Data Import"]})})]},"config"):(0,t.jsxs)(i.motion.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"space-y-8",children:[(0,t.jsx)("div",{className:"flex justify-center",children:(0,t.jsx)("div",{className:"w-16 h-16 rounded-2xl bg-gradient-to-br from-emerald-400 to-emerald-600 flex items-center justify-center shadow-xl shadow-emerald-500/20",children:(0,t.jsx)(s.Store,{className:"w-9 h-9 text-white"})})}),(0,t.jsxs)("div",{className:"text-center space-y-2",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold tracking-tight text-zinc-900 dark:text-zinc-100",children:"Connect your Store"}),(0,t.jsx)("p",{className:"text-sm text-zinc-500",children:"Sync your Shopify data securely with Unclutr Logic."})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(p.Label,{className:"text-xs font-bold uppercase tracking-widest text-zinc-500 pl-1",children:"Shopify Domain"}),(0,t.jsxs)("div",{className:"relative group",children:[(0,t.jsx)(m.Input,{placeholder:"my-store-name",value:N,onChange:e=>C(e.target.value),className:"h-14 pr-32 bg-white dark:bg-zinc-900 border-zinc-200 dark:border-zinc-800 rounded-2xl focus:ring-emerald-500/20 focus:border-emerald-500 transition-all font-medium text-lg"}),(0,t.jsx)("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-sm font-bold text-zinc-400",children:".myshopify.com"})]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(f.Button,{onClick:T,disabled:!N||$,className:"h-14 w-full bg-zinc-950 dark:bg-white text-white dark:text-zinc-950 hover:bg-zinc-800 dark:hover:bg-zinc-100 rounded-2xl font-bold text-lg shadow-2xl transition-all active:scale-95",children:$?(0,t.jsx)(o.Loader2,{className:"w-5 h-5 animate-spin mr-2"}):"Initiate Handshake â†’"}),$&&E&&(0,t.jsxs)(i.motion.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:3},className:"text-center",children:[(0,t.jsx)("p",{className:"text-xs text-zinc-400 mb-2",children:"Taking longer than expected?"}),(0,t.jsx)(f.Button,{variant:"link",asChild:!0,className:"text-emerald-500 h-auto p-0 text-xs font-bold",children:(0,t.jsx)("a",{href:E,children:"Click here to connect manually"})})]})]})]})]},"input")}),(0,t.jsxs)("div",{className:"flex items-center justify-center gap-6 pt-4 text-[10px] font-bold uppercase tracking-widest text-zinc-400 border-t border-zinc-100 dark:border-zinc-800",children:[(0,t.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,t.jsx)(h.History,{className:"w-3.5 h-3.5"})," Immutable Sync"]}),(0,t.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,t.jsx)(d.Sparkles,{className:"w-3.5 h-3.5"})," Logic Powered"]})]})]})})}function N(){return(0,t.jsx)(r.Suspense,{fallback:(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)(o.Loader2,{className:"w-8 h-8 animate-spin text-emerald-500"})}),children:(0,t.jsx)(k,{})})}e.s(["default",()=>N],24230)}]);