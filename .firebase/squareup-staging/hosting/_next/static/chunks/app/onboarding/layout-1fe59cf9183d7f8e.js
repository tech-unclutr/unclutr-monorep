(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6937],{77845:(e,t,a)=>{Promise.resolve().then(a.bind(a,50031))},50031:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>i});var n=a(95155);a(12115);var r=a(14366),s=a(25405);function i(e){let{children:t}=e;return(0,n.jsx)(s.O,{children:(0,n.jsx)(r.X,{children:(0,n.jsx)("div",{className:"bg-white min-h-screen relative",children:t})})})}},25405:(e,t,a)=>{"use strict";a.d(t,{O:()=>c});var n=a(95155),r=a(39196),s=a(76046),i=a(12115),o=a(37310);function c(e){let{children:t}=e,{isAuthenticated:a,loading:c,onboardingCompleted:l,hasSkippedOnboarding:d}=(0,r.A)(),u=(0,s.useRouter)(),h=(0,s.usePathname)();return((0,i.useEffect)(()=>{c||(a?!1!==l||d||(null==h?void 0:h.startsWith("/onboarding"))||u.push("/onboarding/basics"):u.push("/login"))},[a,c,l,d,u,h]),!c&&(!a||!1!==l||d||(null==h?void 0:h.startsWith("/onboarding"))))?a?(0,n.jsx)(n.Fragment,{children:t}):null:(0,n.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-background",children:(0,n.jsx)(o.h,{text:"Securing session..."})})}},37310:(e,t,a)=>{"use strict";a.d(t,{h:()=>s});var n=a(95155),r=a(71226);function s(e){let{text:t="Discovering your business truth"}=e;return(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center space-y-8",children:[(0,n.jsx)("div",{className:"w-48 h-[1px] bg-white/5 relative overflow-hidden",children:(0,n.jsx)(r.P.div,{className:"absolute inset-0 bg-orange-500 shadow-[0_0_15px_rgba(99,102,241,0.5)]",animate:{x:["-100%","100%"]},transition:{duration:3,repeat:1/0,ease:"easeInOut"}})}),(0,n.jsx)("p",{className:"text-xs text-white/40 font-light tracking-[0.2em] uppercase",children:t})]})}},39196:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});var n=a(35901);let r=()=>(0,n.A)()},70071:(e,t,a)=>{"use strict";a.d(t,{o:()=>r});var n=a(12115);function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300,[a,r]=(0,n.useState)(e);return(0,n.useEffect)(()=>{let a=setTimeout(()=>{r(e)},t);return()=>{clearTimeout(a)}},[e,t]),a}},25739:(e,t,a)=>{"use strict";a.d(t,{F:()=>o});var n=a(89664),r=a(2818);let s=r.env.NEXT_PUBLIC_API_URL?"".concat(r.env.NEXT_PUBLIC_API_URL,"/api/v1"):"/api/v1";class i extends Error{constructor(e,t,a){super(e),this.name="ApiError",this.status=t,this.data=a}}let o={async request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=n.auth.currentUser,r=a?await a.getIdToken():null,o=localStorage.getItem("unclutr_company_id"),c={"Content-Type":"application/json",...r?{Authorization:"Bearer ".concat(r)}:{},...o?{"X-Company-ID":o}:{},...t.headers||{}};o||e.startsWith("/execution");let l="".concat(s).concat(e),d=await fetch(l,{...t,cache:"no-store",headers:c});if(!d.ok){let e=await d.json().catch(()=>({detail:"Unknown error"}));throw new i(e.detail||d.statusText,d.status,e)}return d.json()},get(e,t){return this.request(e,{method:"GET",headers:t})},post(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0;return this.request(e,{method:"POST",body:JSON.stringify(t),headers:a})},patch(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0;return this.request(e,{method:"PATCH",body:JSON.stringify(t),headers:a})},put(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0;return this.request(e,{method:"PUT",body:JSON.stringify(t),headers:a})},delete(e,t){return this.request(e,{method:"DELETE",headers:t})}}},14366:(e,t,a)=>{"use strict";a.d(t,{X:()=>h,z:()=>g});var n=a(95155),r=a(12115),s=a(25739),i=a(41082),o=a(35901),c=a(76046),l=a(70071);let d={companyName:"",brandName:"",category:"",region:{country:"",currency:"",timezone:""},channels:{d2c:[],marketplaces:[],qcom:[],others:[]},primaryPartners:{marketplaces:[],qcom:[]},stack:{orders:[],payments:[],shipping:[],payouts:[],marketing:[],analytics:[],finance:[]},integrationRequestsDraft:[]},u=(0,r.createContext)(void 0);function h(e){let{children:t}=e,[a,h]=(0,r.useState)(d),[g,f]=(0,r.useState)(!1),[m,p]=(0,r.useState)(null),v=(0,l.o)(a,1e3),y=(0,r.useRef)(!0),b=(0,r.useRef)(JSON.stringify(d));(0,r.useEffect)(()=>{if(y.current){y.current=!1;return}let e=JSON.stringify(v);e!==b.current&&(w(void 0,!0).catch(e=>console.warn("Auto-save failed",e)),b.current=e)},[v]);let{user:_,skipOnboardingSession:k}=(0,o.A)(),N=(0,c.useRouter)();(0,r.useEffect)(()=>{let e=localStorage.getItem("unclutr_onboarding_draft");if(e)try{let t=JSON.parse(e);h(e=>({...e,...t,region:t.region||e.region}))}catch(e){console.error("Failed to parse saved onboarding state",e)}(async()=>{if(_)try{let l=await s.F.get("/onboarding/state");if(l){if(console.log("DEBUG: Backend Raw Response:",l),l.basics_data&&(l.basics_data.companyName||l.basics_data.brandName)||l.is_completed){var e,t,a,n,r,i,o,c;let s={companyName:(null===(e=l.basics_data)||void 0===e?void 0:e.companyName)||"",brandName:(null===(t=l.basics_data)||void 0===t?void 0:t.brandName)||"",category:(null===(a=l.basics_data)||void 0===a?void 0:a.category)||"",region:(null===(n=l.basics_data)||void 0===n?void 0:n.region)||d.region,channels:(null===(r=l.channels_data)||void 0===r?void 0:r.channels)||l.channels_data||d.channels,primaryPartners:(null===(i=l.channels_data)||void 0===i?void 0:i.primaryPartners)||d.primaryPartners,stack:(null===(o=l.stack_data)||void 0===o?void 0:o.stack)||l.stack_data||d.stack,integrationRequestsDraft:(null===(c=l.finish_data)||void 0===c?void 0:c.integrationRequestsDraft)||[]};h(e=>({...e,...s})),console.log("Hydrated from backend:",s)}else console.log("Backend state is empty, keeping local draft.")}}catch(e){console.warn("No existing onboarding state found or fetch failed",e)}})()},[_]);let w=async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t||f(!0),f(!0);try{let t=window.location.pathname,n=e||"basics";if(!e&&(t.includes("/channels")?n="channels":t.includes("/stack")?n="stack":t.includes("/finish")&&(n="finish")),console.log("Saving to backend...",{page:n,state:a}),!["basics","channels","stack","finish"].includes(n)){console.warn("Attempting to save on invalid page:",n),f(!1);return}let r={};"basics"===n?r={companyName:a.companyName,brandName:a.brandName,category:a.category,region:a.region}:"channels"===n?r={selectedChannels:[...a.channels.d2c||[],...a.channels.marketplaces||[],...a.channels.qcom||[],...a.channels.others||[]],channels:a.channels,primaryPartners:a.primaryPartners}:"stack"===n&&(r={selectedTools:[...a.stack.orders||[],...a.stack.payments||[],...a.stack.shipping||[],...a.stack.payouts||[],...a.stack.marketing||[],...a.stack.analytics||[],...a.stack.finance||[]],stack:a.stack}),await i.S.onboarding.saveProgressApiV1OnboardingSavePost({requestBody:{page:n,data:r}}),p(new Date),f(!1)}catch(e){throw console.error("Failed to save state:",e),f(!1),e}},S=async()=>{try{await w(),k(),N.push("/dashboard")}catch(e){alert("Failed to save progress. Please check connection.")}};return(0,n.jsx)(u.Provider,{value:{state:a,updateState:e=>{h(t=>{let a={...t,...e};return localStorage.setItem("unclutr_onboarding_draft",JSON.stringify(a)),a})},updateChannels:e=>{h(t=>{let a={...t,channels:{...t.channels,...e}};return localStorage.setItem("unclutr_onboarding_draft",JSON.stringify(a)),a})},updatePrimaryPartners:e=>{h(t=>{let a={...t,primaryPartners:{...t.primaryPartners,...e}};return localStorage.setItem("unclutr_onboarding_draft",JSON.stringify(a)),a})},updateStack:e=>{h(t=>{let a={...t,stack:{...t.stack,...e}};return localStorage.setItem("unclutr_onboarding_draft",JSON.stringify(a)),a})},addIntegrationRequest:(e,t)=>{h(a=>{let n={...a,integrationRequestsDraft:[...a.integrationRequestsDraft,{term:e,context:t}]};return localStorage.setItem("unclutr_onboarding_draft",JSON.stringify(n)),n})},saveAndExit:S,saveCurrentPage:w,isSaving:g,lastSavedAt:m},children:t})}function g(){let e=(0,r.useContext)(u);if(void 0===e)throw Error("useOnboarding must be used within an OnboardingProvider");return e}},18244:(e,t,a)=>{"use strict";function n(e,t,a){if(!t.has(e))throw TypeError("attempted to "+a+" private field on non-instance");return t.get(e)}a.d(t,{_:()=>n})},95359:(e,t,a)=>{"use strict";a.d(t,{_:()=>r});var n=a(18244);function r(e,t){var a=(0,n._)(e,t,"get");return a.get?a.get.call(e):a.value}},50587:(e,t,a)=>{"use strict";function n(e,t,a){!function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,a)}a.d(t,{_:()=>n})},75465:(e,t,a)=>{"use strict";a.d(t,{_:()=>r});var n=a(18244);function r(e,t,a){var r=(0,n._)(e,t,"set");return!function(e,t,a){if(t.set)t.set.call(e,a);else{if(!t.writable)throw TypeError("attempted to set read only private field");t.value=a}}(e,r,a),a}}},e=>{var t=t=>e(e.s=t);e.O(0,[5563,1431,1226,5714,5901,1082,8441,1517,7358],()=>t(77845)),_N_E=e.O()}]);