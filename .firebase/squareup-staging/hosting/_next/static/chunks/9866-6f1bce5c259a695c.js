"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9866],{47738:(e,t,a)=>{a.d(t,{P:()=>p});var r=a(95155),s=a(12115),n=a(7837),i=a(25858),o=a(9955),l=a(20853),d=a(14505),c=a(98867),x=a(29602),m=a(30814),g=a(39196);let u=e=>{if(!e.logo_url)return null;if(e.logo_url.startsWith("/")||e.logo_url.startsWith("logos/"))return e.logo_url;if(e.logo_url.includes("logo.clearbit.com")&&e.website_url)try{let t=new URL(e.website_url).hostname.replace("www.","");return"https://cdn.brandfetch.io/".concat(t,"/symbol.svg?c=1id0mlmgxmrC1sPyh2v")}catch(e){}return e.logo_url},h={selling_channel_d2c:"Storefront (D2C)",selling_channel_marketplace:"Marketplace",selling_channel_qcom:"Quick Commerce",stack_payments:"Payments",stack_shipping:"Logistics",stack_marketing:"Marketing",stack_analytics:"Analytics & CRM",stack_finance:"Accounting"},p=e=>{let{open:t,onOpenChange:p,onAdd:f}=e,{companyId:b}=(0,g.A)(),[y,v]=(0,s.useState)(""),[j,w]=(0,s.useState)({}),[N,k]=(0,s.useState)(new Set),[z,_]=(0,s.useState)(new Set),[C,A]=(0,s.useState)(!1),[S,F]=(0,s.useState)(!0),[I,D]=(0,s.useState)(!1);(0,s.useEffect)(()=>{t&&b&&E()},[t,b]);let E=async()=>{try{F(!0);let e=(await Promise.resolve().then(a.bind(a,89664))).auth.currentUser;if(!e){m.oR.error("Sign-in Required",{description:"Please log in to continue configuring your business stack."});return}let t=await e.getIdToken();console.log("[AddSourceDialog] Fetching datasources from /api/v1/datasources/all");let r=await fetch("/api/v1/datasources/all",{headers:{Authorization:"Bearer ".concat(t),"X-Company-ID":b}});if(console.log("[AddSourceDialog] Datasources response status:",r.status,r.statusText),!r.ok){let e=await r.text();throw console.error("[AddSourceDialog] Datasources fetch failed:",e),Error("Failed to fetch datasources")}let s=await r.json();console.log("[AddSourceDialog] Datasources received:",s),w(s);let n=await fetch("/api/v1/company/me",{headers:{Authorization:"Bearer ".concat(t),"X-Company-ID":b}});if(n.ok){let e=await n.json();console.log("[AddSourceDialog] Company data:",e);let a=e.stack_data,r=e.channels_data,s=!a||0===Object.keys(a.stack||{}).length&&0===(a.selectedTools||[]).length,i=!r||0===Object.keys(r.channels||{}).length;if(s&&i){console.log("[AddSourceDialog] Production stack is empty, checking onboarding state...");try{let e=await fetch("/api/v1/onboarding/state",{headers:{Authorization:"Bearer ".concat(t)}});if(e.ok){let t=await e.json();console.log("[AddSourceDialog] Onboarding data found:",t),a=t.stack_data,r=t.channels_data}}catch(e){console.error("[AddSourceDialog] Failed to fetch onboarding fallback:",e)}}console.log("[AddSourceDialog] Using Stack data:",a),console.log("[AddSourceDialog] Using Channels data:",r);let o=new Set;if(a){let e=a.stack||{};Object.values(e).forEach(e=>{Array.isArray(e)&&e.forEach(e=>o.add(String(e).toLowerCase()))}),(a.selectedTools||[]).forEach(e=>o.add(String(e).toLowerCase()))}if(r){let e=r.channels||{};Object.values(e).forEach(e=>{Array.isArray(e)&&e.forEach(e=>o.add(String(e).toLowerCase()))})}console.log("[AddSourceDialog] Final selected IDs:",Array.from(o)),k(o),_(new Set(o))}}catch(e){console.error("Error fetching datasources:",e),m.oR.error("The catalog is playing hide and seek",{description:"We couldn’t fetch the available tools. Try reloading the page?"})}finally{F(!1)}},P=e=>{let t=e.id.toLowerCase(),a=new Set(N);a.has(t)?a.delete(t):a.add(t),k(a)},R=async()=>{try{D(!0);let e=(await Promise.resolve().then(a.bind(a,89664))).auth.currentUser;if(!e){m.oR.error("Sign-in Required",{description:"Please log in to save your business stack selections."});return}let t=await e.getIdToken(),r=Array.from(N);if(!(await fetch("/api/v1/datasources/company/stack",{method:"PUT",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json","X-Company-ID":b},body:JSON.stringify({datasource_ids:r})})).ok)throw Error("Failed to update stack");m.oR.success("Stack Unified",{description:"Your business tools are now synchronized with your datastack."}),p(!1),window.location.reload()}catch(e){console.error("Error updating stack:",e),m.oR.error("Sync hit a snag",{description:"We couldn’t save your selections. Let’s try once more?"})}finally{D(!1)}},T=Object.entries(j).reduce((e,t)=>{let[a,r]=t,s=r.filter(e=>e.name.toLowerCase().includes(y.toLowerCase())||e.slug.toLowerCase().includes(y.toLowerCase()));return s.length>0&&(e[a]=s),e},{}),L=()=>{N.size!==z.size||Array.from(N).some(e=>!z.has(e))?A(!0):p(!1)};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.lG,{open:t,onOpenChange:e=>{e||L()},children:(0,r.jsxs)(n.Cf,{className:"sm:max-w-[900px] h-[85vh] border-0 bg-gradient-to-br from-zinc-50 via-white to-zinc-50 dark:from-zinc-950 dark:via-zinc-900 dark:to-zinc-950 p-0 overflow-hidden flex flex-col shadow-2xl",children:[(0,r.jsxs)(n.c7,{className:"relative p-6 pb-4 border-b border-gray-100 dark:border-zinc-800 bg-gradient-to-r from-white via-orange-50/30 to-white dark:from-zinc-900 dark:via-orange-950/20 dark:to-zinc-900 z-10 shrink-0",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-orange-500/5 via-transparent to-orange-500/5 pointer-events-none"}),(0,r.jsx)(n.L3,{className:"relative text-2xl font-bold font-display tracking-tight bg-gradient-to-r from-zinc-900 via-orange-600 to-zinc-900 dark:from-zinc-50 dark:via-orange-400 dark:to-zinc-50 bg-clip-text text-transparent",children:"Manage Toolkit"}),(0,r.jsx)(n.rr,{className:"relative text-zinc-600 dark:text-zinc-400 font-medium",children:"Select the operational tools that power your business."})]}),(0,r.jsx)("div",{className:"px-6 py-4 bg-white/80 dark:bg-zinc-900/80 backdrop-blur-xl border-b border-gray-100 dark:border-zinc-800 shrink-0",children:(0,r.jsxs)("div",{className:"relative group",children:[(0,r.jsx)(l.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 group-focus-within:text-[#FF8A4C] transition-colors duration-300"}),(0,r.jsx)(o.p,{placeholder:"Search apps (e.g. Shopify, Razorpay)...",className:"pl-10 h-11 bg-gray-50/80 dark:bg-zinc-800/80 backdrop-blur-sm border-gray-200/50 dark:border-zinc-700/50 focus:bg-white dark:focus:bg-zinc-950 rounded-xl focus:ring-2 focus:ring-[#FF8A4C]/30 focus:border-[#FF8A4C] transition-all duration-300 shadow-sm focus:shadow-lg focus:shadow-orange-500/10",value:y,onChange:e=>v(e.target.value)})]})}),(0,r.jsx)("div",{className:"flex-1 overflow-y-auto p-6 bg-gray-50/50 dark:bg-zinc-950",children:S?(0,r.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,r.jsx)(d.A,{className:"w-8 h-8 animate-spin text-[#FF8A4C] opacity-50"})}):Object.keys(T).length>0?(0,r.jsx)("div",{className:"space-y-10 pb-10",children:Object.entries(T).map(e=>{let[t,a]=e;return(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 sticky top-0 bg-gradient-to-r from-gray-50/95 via-white/95 to-gray-50/95 dark:from-zinc-950/95 dark:via-zinc-900/95 dark:to-zinc-950/95 backdrop-blur-md py-3 z-10 border-b border-orange-100/30 dark:border-orange-900/20",children:[(0,r.jsx)("div",{className:"w-1.5 h-1.5 rounded-full bg-gradient-to-r from-orange-500 to-orange-600 shadow-lg shadow-orange-500/50"}),(0,r.jsx)("h3",{className:"text-xs font-bold text-transparent bg-gradient-to-r from-gray-700 to-gray-500 dark:from-zinc-300 dark:to-zinc-500 bg-clip-text uppercase tracking-widest",children:h[t]||t})]}),(0,r.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:a.map(e=>{let t=N.has(e.id.toLowerCase());return(0,r.jsxs)("button",{onClick:()=>P(e),className:(0,x.cn)("group relative flex flex-col items-start gap-4 p-4 rounded-2xl border transition-all duration-300 text-left h-full overflow-hidden",t?"border-transparent bg-gradient-to-br from-white via-orange-50/50 to-white dark:from-zinc-900 dark:via-orange-950/30 dark:to-zinc-900 shadow-[0_0_0_2px_#FF8A4C,0_8px_24px_-4px_rgba(255,138,76,0.3)] scale-[1.02]":"border-gray-200 dark:border-zinc-800 bg-white dark:bg-zinc-900 hover:border-orange-200 dark:hover:border-orange-900/50 hover:shadow-[0_8px_32px_-8px_rgba(255,138,76,0.2)] hover:-translate-y-1 hover:scale-[1.01]"),children:[(0,r.jsx)("div",{className:(0,x.cn)("absolute inset-0 bg-gradient-to-br from-orange-500/0 via-orange-500/0 to-orange-500/0 opacity-0 transition-opacity duration-500 pointer-events-none",t?"from-orange-500/5 via-orange-500/5 to-orange-500/5 opacity-100":"group-hover:opacity-100 group-hover:from-orange-500/3 group-hover:via-orange-500/3 group-hover:to-orange-500/3")}),(0,r.jsxs)("div",{className:"flex items-start justify-between w-full relative z-10",children:[(0,r.jsxs)("div",{className:(0,x.cn)("w-12 h-12 rounded-xl bg-gradient-to-br from-gray-50 to-gray-100 dark:from-zinc-800 dark:to-zinc-900 border flex items-center justify-center p-2 overflow-hidden transition-all duration-300",t?"border-orange-200 dark:border-orange-900/50 shadow-lg shadow-orange-500/20":"border-gray-100 dark:border-zinc-700 group-hover:border-orange-100 dark:group-hover:border-orange-900/30 group-hover:shadow-md"),children:[(()=>{let t=u(e);return t&&!t.includes("default.png")&&(t.startsWith("/")||t.startsWith("http"))?(0,r.jsx)("img",{src:t,alt:e.name,className:"w-full h-full object-contain transition-transform duration-300 group-hover:scale-110",onError:e=>{e.currentTarget.style.display="none";let t=e.currentTarget.nextElementSibling;t&&(t.style.display="flex")}}):null})(),(0,r.jsx)("div",{className:"text-lg font-bold text-gray-400 hidden w-full h-full items-center justify-center",style:{display:(()=>{let t=u(e);return t&&!t.includes("default.png")&&(t.startsWith("/")||t.startsWith("http"))?"none":"flex"})()},children:e.name[0]})]}),(0,r.jsx)("div",{className:(0,x.cn)("w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all duration-300",t?"border-[#FF8A4C] bg-gradient-to-br from-[#FF8A4C] to-orange-600 scale-100 shadow-lg shadow-orange-500/30":"border-gray-200 dark:border-zinc-700 opacity-0 group-hover:opacity-100 scale-90 group-hover:scale-100"),children:t&&(0,r.jsx)(c.A,{className:"w-3.5 h-3.5 text-white animate-in zoom-in duration-200",strokeWidth:3})})]}),(0,r.jsxs)("div",{className:"w-full relative z-10",children:[(0,r.jsx)("div",{className:(0,x.cn)("font-bold text-gray-900 dark:text-zinc-100 mb-0.5 transition-all duration-300",t?"text-[#FF8A4C] dark:text-orange-400":"group-hover:text-[#FF8A4C] dark:group-hover:text-orange-400"),children:e.name}),e.is_coming_soon?(0,r.jsx)("div",{className:"text-[10px] font-bold uppercase tracking-wider text-zinc-400 bg-zinc-100 dark:bg-zinc-800/50 px-1.5 py-0.5 rounded-md w-fit mt-1",children:"Soon"}):(0,r.jsx)("div",{className:"text-xs text-gray-400 dark:text-zinc-500 line-clamp-2 leading-relaxed",children:e.description||"Integration available"})]})]},e.id)})})]},t)})}):(0,r.jsxs)("div",{className:"h-full flex flex-col items-center justify-center text-center space-y-4 opacity-60",children:[(0,r.jsx)("div",{className:"p-4 rounded-full bg-gray-100 dark:bg-zinc-800",children:(0,r.jsx)(l.A,{className:"w-8 h-8 text-gray-400"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-bold text-lg text-gray-900 dark:text-gray-100",children:"No apps found"}),(0,r.jsxs)("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:["We couldn't find any results for \"",y,'"']})]})]})}),(0,r.jsxs)("div",{className:"p-6 bg-gradient-to-r from-white via-orange-50/20 to-white dark:from-zinc-900 dark:via-orange-950/10 dark:to-zinc-900 border-t border-gray-100 dark:border-zinc-800 flex items-center justify-between shrink-0 z-20 shadow-[0_-8px_32px_rgba(0,0,0,0.04)] backdrop-blur-xl",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500 dark:text-zinc-400",children:[(0,r.jsx)("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-gradient-to-br from-orange-100 to-orange-200 dark:from-orange-900/40 dark:to-orange-900/20 text-[#FF8A4C] text-sm font-bold shadow-lg shadow-orange-500/20 animate-pulse",children:N.size}),(0,r.jsx)("span",{className:"font-semibold",children:"apps selected"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("button",{onClick:()=>p(!1),className:"px-5 py-2.5 text-sm font-bold text-gray-600 dark:text-zinc-400 hover:bg-gray-100 dark:hover:bg-zinc-800 rounded-xl transition-all duration-300 hover:scale-105 active:scale-95",children:"Cancel"}),(0,r.jsx)("button",{onClick:R,disabled:I,className:"px-8 py-2.5 bg-gradient-to-r from-[#FF8A4C] to-orange-600 hover:from-[#FF8A4C]/90 hover:to-orange-600/90 text-white font-bold text-sm rounded-xl shadow-lg shadow-orange-500/30 hover:shadow-xl hover:shadow-orange-500/40 active:translate-y-0.5 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 hover:scale-105 active:scale-95",children:I?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.A,{className:"w-4 h-4 animate-spin"}),"Syncing Stack..."]}):"Update Stack"})]})]})]})}),(0,r.jsx)(i.Lt,{open:C,onOpenChange:A,children:(0,r.jsxs)(i.EO,{children:[(0,r.jsxs)(i.wd,{children:[(0,r.jsx)(i.r7,{children:"Unsaved Changes"}),(0,r.jsx)(i.$v,{children:"You have unsaved changes in your stack selection. Are you sure you want to close without saving? Your changes will be lost."})]}),(0,r.jsxs)(i.ck,{children:[(0,r.jsx)(i.Zr,{children:"Cancel"}),(0,r.jsx)(i.Rx,{onClick:()=>{A(!1),p(!1)},className:"bg-orange-500 hover:bg-orange-600 text-white",children:"Discard Changes"})]})]})})]})}},73748:(e,t,a)=>{a.d(t,{f:()=>f});var r=a(95155);a(12115);var s=a(14085),n=a(35007),i=a(26336),o=a(21773),l=a(30098),d=a(42640),c=a(92598),x=a(85047),m=a(23888),g=a(33473),u=a(29602),h=a(71226),p=a(28633);let f=e=>{var t;let{integration:a,onConnect:f,onViewDetails:b,onAdd:y,onRefresh:v,onSync:j}=e,w="active"===a.status,N="syncing"===a.status||"SYNCING"===a.status,k="error"===a.status,z=a.in_stack,_=a.datasource.is_implemented,C=w||N||k;return(0,r.jsx)(h.P.div,{layout:!0,initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.3},className:"h-full",children:(0,r.jsxs)(n.Zp,{className:"group relative h-full flex flex-col w-full p-6 border-zinc-200 dark:border-zinc-800 bg-white dark:bg-zinc-900 shadow-sm hover:shadow-xl dark:hover:shadow-zinc-900/50 hover:-translate-y-1 transition-all duration-300 ease-spring overflow-hidden",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-zinc-50/50 via-transparent to-transparent dark:from-zinc-800/20 dark:to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500 pointer-events-none"}),(0,r.jsxs)("div",{className:"relative z-10 flex items-start gap-5 mb-6",children:[(0,r.jsxs)("div",{className:"relative shrink-0",children:[(0,r.jsx)("div",{className:"w-14 h-14 rounded-2xl bg-white dark:bg-zinc-900 border border-zinc-100 dark:border-zinc-800 flex items-center justify-center p-2.5 shadow-sm group-hover:shadow-md group-hover:scale-105 transition-all duration-300 ease-spring",children:a.datasource.logo_url?(0,r.jsx)("img",{src:a.datasource.logo_url,alt:a.datasource.name,className:"w-full h-full object-contain drop-shadow-sm"}):(0,r.jsx)("div",{className:"w-full h-full bg-orange-50 dark:bg-orange-900/20 rounded-lg flex items-center justify-center text-orange-600 dark:text-orange-400 font-bold text-xl",children:a.datasource.name[0]})}),C&&(0,r.jsx)("div",{className:"absolute -bottom-1 -right-1 w-5 h-5 rounded-full bg-emerald-500 ring-2 ring-white dark:ring-zinc-900 flex items-center justify-center shadow-sm z-20",children:(0,r.jsx)(i.A,{className:"w-3 h-3 text-white",strokeWidth:3})})]}),(0,r.jsxs)("div",{className:"min-w-0 flex-1 py-1",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,r.jsx)("h3",{className:"font-bold text-lg text-zinc-900 dark:text-zinc-100 truncate tracking-tight group-hover:text-primary transition-colors duration-300",children:a.datasource.name}),!_&&(0,r.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-wider text-zinc-400 bg-zinc-100 dark:bg-zinc-800 px-1.5 py-0.5 rounded text-center min-w-[3rem]",children:"Soon"})]}),(0,r.jsx)("div",{className:"flex flex-col gap-1 mt-1.5",children:(null===(t=a.metadata_info)||void 0===t?void 0:t.shop)?(0,r.jsx)("span",{className:"text-xs font-medium text-zinc-500 dark:text-zinc-400 truncate font-mono",children:a.metadata_info.shop.replace(".myshopify.com","")}):(0,r.jsx)("p",{className:"text-xs text-zinc-500 dark:text-zinc-500 line-clamp-2 leading-relaxed",children:a.datasource.description||"Integrate ".concat(a.datasource.name," with your stack.")})})]})]}),(0,r.jsxs)("div",{className:"relative z-10 flex items-center justify-between gap-4 mb-6",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:w?(0,r.jsxs)("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-full bg-emerald-500/10 border border-emerald-500/20 text-[10px] font-bold text-emerald-600 dark:text-emerald-400 shadow-sm group-hover:bg-emerald-500/15 transition-colors",children:[(0,r.jsxs)("span",{className:"relative flex h-2 w-2",children:[(0,r.jsx)("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"}),(0,r.jsx)("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-emerald-500"})]}),"Active"]}):N?(0,r.jsxs)("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-full bg-blue-500/10 border border-blue-500/20 text-[10px] font-bold text-blue-600 dark:text-blue-400 shadow-sm",children:[(0,r.jsx)(o.A,{className:"w-3.5 h-3.5 animate-spin"}),"Syncing"]}):z?(0,r.jsxs)("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-full bg-orange-500/10 border border-orange-500/20 text-[10px] font-bold text-orange-600 dark:text-orange-400 shadow-sm",children:[(0,r.jsx)(l.A,{className:"w-3.5 h-3.5"}),"In Stack"]}):(0,r.jsx)("div",{className:"px-3 py-1.5 rounded-full bg-zinc-100 dark:bg-zinc-800 text-[10px] font-medium text-zinc-500 border border-zinc-200 dark:border-zinc-700/50",children:"Not Connected"})}),(0,r.jsxs)("div",{className:"flex flex-col items-end gap-1.5 whitespace-nowrap",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-[9px] font-bold text-zinc-400 dark:text-zinc-500 uppercase tracking-wide",children:[(0,r.jsx)("span",{children:"Enterprise Security"}),(0,r.jsx)(d.A,{className:"w-3 h-3"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 text-[9px] font-bold text-zinc-400 dark:text-zinc-500 uppercase tracking-wide",children:[(0,r.jsx)("span",{children:"Read-only Access"}),(0,r.jsx)(c.A,{className:"w-3 h-3"})]})]})]}),(0,r.jsx)("div",{className:"mt-auto pt-5 border-t border-zinc-100 dark:border-zinc-800/50",children:(0,r.jsx)(p.N,{mode:"wait",children:C?(0,r.jsxs)(h.P.div,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},className:"grid grid-cols-2 gap-3",children:[(0,r.jsxs)(s.$,{variant:"outline",size:"sm",onClick:()=>b(a),className:"w-full h-9 rounded-lg border-zinc-200 dark:border-zinc-700 bg-white dark:bg-zinc-800/50 hover:bg-zinc-50 dark:hover:bg-zinc-800 text-xs font-semibold text-zinc-700 dark:text-zinc-200 group/btn shadow-sm cursor-pointer",children:[(0,r.jsx)(x.A,{className:"w-3.5 h-3.5 mr-2 group-hover/btn:rotate-45 transition-transform text-zinc-400 group-hover/btn:text-zinc-600 dark:group-hover/btn:text-zinc-300"}),"Configure"]}),(0,r.jsxs)(s.$,{variant:"ghost",size:"sm",onClick:e=>{e.stopPropagation(),j&&j(a.id)},disabled:N,className:"w-full h-9 rounded-lg hover:bg-emerald-50 dark:hover:bg-emerald-900/10 text-xs font-semibold text-zinc-500 dark:text-zinc-400 hover:text-emerald-600 dark:hover:text-emerald-400 transition-colors cursor-pointer disabled:cursor-not-allowed",children:[(0,r.jsx)(m.A,{className:(0,u.cn)("w-3.5 h-3.5 mr-2",N&&"animate-spin")}),N?"Syncing...":"Sync Now"]})]}):(0,r.jsx)(h.P.div,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},className:"flex items-center gap-3",children:_?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.$,{onClick:e=>{e.stopPropagation(),f(a.datasource.slug)},size:"sm",className:"flex-1 h-9 rounded-lg bg-zinc-900 dark:bg-white text-white dark:text-black hover:bg-zinc-800 dark:hover:bg-zinc-100 font-bold text-xs shadow-sm hover:shadow-md hover:-translate-y-0.5 transition-all active:translate-y-0 active:shadow-sm cursor-pointer",children:"Connect"}),z?(0,r.jsx)(s.$,{variant:"ghost",size:"sm",className:"aspect-square h-9 p-0 rounded-lg text-orange-500 bg-orange-50 dark:bg-orange-500/10 cursor-default",children:(0,r.jsx)(l.A,{className:"w-4 h-4"})}):(0,r.jsx)(s.$,{variant:"outline",size:"sm",onClick:e=>{e.stopPropagation(),y&&y(a.datasource.slug,a.datasource.category)},className:"aspect-square h-9 p-0 rounded-lg border-zinc-200 dark:border-zinc-700 text-zinc-400 hover:text-orange-500 hover:border-orange-200 hover:bg-orange-50 dark:hover:bg-orange-900/10 transition-colors shadow-sm bg-white dark:bg-zinc-800/50 cursor-pointer",children:(0,r.jsx)(g.A,{className:"w-4 h-4"})})]}):(0,r.jsx)(s.$,{disabled:!0,variant:"outline",className:"w-full h-9 rounded-lg bg-zinc-50 dark:bg-zinc-900 border-dashed border-zinc-200 dark:border-zinc-800 text-zinc-400 text-xs font-medium cursor-not-allowed opacity-70",children:"Coming Soon"})})})}),N&&(0,r.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-zinc-100 dark:bg-zinc-800 overflow-hidden rounded-b-xl",children:(0,r.jsx)("div",{className:"h-full bg-emerald-500 animate-progress origin-left",style:{width:"100%"}})})]})})}},17432:(e,t,a)=>{a.d(t,{P:()=>H});var r=a(95155),s=a(12115),n=a(30042),i=a(31027),o=a(40767),l=a(29602);let d=n.bL;n.l9,n.bm;let c=n.ZL,x=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.hJ,{className:(0,l.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...s,ref:t})});x.displayName=n.hJ.displayName;let m=(0,i.F)("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),g=s.forwardRef((e,t)=>{let{side:a="right",className:s,children:i,...d}=e;return(0,r.jsxs)(c,{children:[(0,r.jsx)(x,{}),(0,r.jsxs)(n.UC,{ref:t,className:(0,l.cn)(m({side:a}),s),...d,children:[(0,r.jsxs)(n.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[(0,r.jsx)(o.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]}),i]})]})});g.displayName=n.UC.displayName;let u=e=>{let{className:t,...a}=e;return(0,r.jsx)("div",{className:(0,l.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...a})};u.displayName="SheetHeader";let h=e=>{let{className:t,...a}=e;return(0,r.jsx)("div",{className:(0,l.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};h.displayName="SheetFooter";let p=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.hE,{ref:t,className:(0,l.cn)("text-lg font-semibold text-foreground",a),...s})});p.displayName=n.hE.displayName;let f=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.VY,{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",a),...s})});f.displayName=n.VY.displayName;var b=a(39286),y=a(14085),v=a(23888),j=a(21773),w=a(23817),N=a(30098),k=a(48617),z=a(42640),_=a(92598),C=a(81476),A=a(45686),S=a(9246),F=a(28633),I=a(71226),D=a(5870),E=a(14505);let P=[{id:"handshake",label:"Security Handshake",description:"Establishing encrypted tunnel"},{id:"cataloging",label:"Cataloging Metadata",description:"Mapping store architecture"},{id:"backfilling",label:"Streaming Records",description:"Fetching historical data"},{id:"refining",label:"AI Analysis",description:"Refining metrics & trends"},{id:"finalizing",label:"Established Feed",description:"Activating real-time stream"}],R=e=>{let{status:t,lastSynced:a,syncStats:s={},onSync:n}=e,i="syncing"===t||"SYNCING"===t,o=s.current_step||"handshake",d=s.progress||0,c=P.findIndex(e=>e.id===o),x=P[c]||P[0];return(0,r.jsx)("div",{className:"rounded-2xl border border-gray-100 dark:border-zinc-800 bg-white dark:bg-zinc-950 transition-all duration-300 overflow-hidden relative group",children:(0,r.jsxs)("div",{className:"p-5 flex flex-col gap-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:(0,l.cn)("w-2.5 h-2.5 rounded-full transition-all duration-500",i?"bg-blue-500 animate-pulse ring-4 ring-blue-500/20":"bg-emerald-500 shadow-[0_0_12px_rgba(16,185,129,0.4)]")}),(0,r.jsx)("h3",{className:"text-sm font-bold text-gray-900 dark:text-gray-100",children:i?"Updating Pulse":"Fully Caught Up"})]}),(0,r.jsx)("p",{className:"text-[11px] text-gray-400 dark:text-zinc-500 font-medium whitespace-nowrap",children:i?"Step ".concat(c+1," of 5"):"Last updated ".concat((e=>{if(!e)return"Sync pending";try{let t=e.endsWith("Z")||e.includes("+")?e:e+"Z",a=new Date(t),r=(new Date().getTime()-a.getTime())/1e3;if(r<60)return"Just now";if(r<3600)return"".concat(Math.floor(r/60),"m ago");if(r<86400)return"".concat(Math.floor(r/3600),"h ago");return"".concat(Math.floor(r/86400),"d ago")}catch(e){return"Unknown"}})(a))})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-gray-50 dark:bg-zinc-900 border border-gray-100 dark:border-zinc-800",children:[(0,r.jsx)(D.A,{className:"w-3.5 h-3.5 text-orange-500"}),(0,r.jsx)("span",{className:"text-xs font-bold text-gray-900 dark:text-gray-100 tabular-nums",children:s.orders_count||0}),(0,r.jsx)("span",{className:"text-[9px] text-gray-400 dark:text-zinc-500 font-bold uppercase tracking-wider",children:"Orders"})]})]}),(0,r.jsx)(F.N,{mode:"wait",children:i&&(0,r.jsxs)(I.P.div,{initial:{opacity:0,height:0,y:10},animate:{opacity:1,height:"auto",y:0},exit:{opacity:0,height:0,y:-10},className:"space-y-4 pt-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4 bg-gray-50/50 dark:bg-white/5 p-3 rounded-xl border border-gray-100 dark:border-white/5 transition-all",children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center bg-blue-500/10 border border-blue-500/20 text-blue-500 shadow-[0_0_10px_rgba(59,130,246,0.1)]",children:(0,r.jsx)(E.A,{className:"w-4 h-4 animate-spin"})}),(0,r.jsxs)("div",{className:"flex flex-col min-w-0",children:[(0,r.jsx)("span",{className:"text-xs font-bold text-gray-900 dark:text-gray-100",children:x.label}),(0,r.jsx)("span",{className:"text-[10px] text-gray-400 dark:text-zinc-500 truncate",children:x.description})]}),(0,r.jsxs)("div",{className:"ml-auto text-[10px] font-bold text-blue-500 bg-blue-500/10 px-2 py-0.5 rounded-full tabular-nums",children:[d,"%"]})]}),(0,r.jsx)("div",{className:"space-y-1.5 px-0.5",children:(0,r.jsx)("div",{className:"h-1 w-full bg-gray-100 dark:bg-zinc-900/50 rounded-full overflow-hidden",children:(0,r.jsx)(I.P.div,{className:"h-full bg-blue-500 shadow-[0_0_8px_rgba(59,130,246,0.5)]",initial:{width:"0%"},animate:{width:"".concat(d,"%")},transition:{duration:.8,ease:"easeOut"}})})})]},o)})]})})};var T=a(67072),L=a(3392),O=a(89664);let U=async()=>{let e=O.auth.currentUser;return e?await e.getIdToken():null};var B=a(2818);function W(e){let{integrationId:t,open:a,companyId:n,workspaceId:i,onSyncTriggered:o}=e,[l,d]=(0,s.useState)([]),[c,x]=(0,s.useState)(!1),[m,g]=(0,s.useState)(Date.now());(0,s.useEffect)(()=>{let e;if(!a){x(!1);return}let r=!0,s=async()=>{if(r)try{let e=await U();if(!e)return;let a=B.env.NEXT_PUBLIC_API_URL||"http://localhost:8000",s="".concat(a,"/api/v1/integrations/shopify/activity?integration_id=").concat(t,"&limit=15&important_only=true"),o=await fetch(s,{headers:{Authorization:"Bearer ".concat(e),"X-Company-ID":n||"","X-Workspace-ID":i||""}});if(o.ok){let e=await o.json();r&&(x(!0),d(t=>{let a=[...e,...t],r=new Map;return a.forEach(e=>{r.has(e.id)||r.set(e.id,e)}),Array.from(r.values()).sort((e,t)=>new Date(t.timestamp).getTime()-new Date(e.timestamp).getTime())}))}}catch(e){console.error("Activity stream error",e),r&&x(!1)}finally{r&&(e=setTimeout(s,3500))}};return s(),()=>{r=!1,e&&clearTimeout(e)}},[t,a,m]),(0,s.useEffect)(()=>{o&&(window.__clearActivityFeed=()=>{d([]),g(Date.now())})},[o]);let u=e=>new Date(e.endsWith("Z")||e.includes("+")?e:e+"Z").toLocaleTimeString([],{hour12:!0,hour:"2-digit",minute:"2-digit"});return(0,r.jsxs)("div",{className:"rounded-2xl border border-gray-100 dark:border-zinc-800 bg-white dark:bg-zinc-900/50 shadow-sm overflow-hidden flex flex-col h-[380px]",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between px-5 py-4 border-b border-gray-100 dark:border-zinc-800/80 bg-white dark:bg-zinc-900 sticky top-0 z-10",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2.5",children:[(0,r.jsx)("div",{className:"p-1.5 rounded-full bg-orange-50 dark:bg-orange-500/10 text-orange-600 dark:text-orange-400",children:(0,r.jsx)(T.A,{className:"w-3.5 h-3.5"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 tracking-tight",children:"Live Activity"}),(0,r.jsx)("p",{className:"text-[10px] text-gray-500 dark:text-gray-400 font-medium",children:"Real-time synchronization events"})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 px-2.5 py-1 rounded-full border transition-all duration-500 ".concat(c?"bg-emerald-50 dark:bg-emerald-500/10 border-emerald-100 dark:border-emerald-500/20":"bg-amber-50 dark:bg-amber-500/10 border-amber-100 dark:border-amber-500/20"),children:[(0,r.jsxs)("span",{className:"relative flex h-2 w-2",children:[c&&(0,r.jsx)("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"}),(0,r.jsx)("span",{className:"relative inline-flex rounded-full h-2 w-2 ".concat(c?"bg-emerald-500":"bg-amber-500")})]}),(0,r.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-widest ".concat(c?"text-emerald-600 dark:text-emerald-400":"text-amber-600 dark:text-amber-400"),children:c?"Live":"Syncing"})]})]}),(0,r.jsx)(L.F,{className:"flex-1 bg-gray-50/30 dark:bg-zinc-950/20",children:(0,r.jsx)("div",{className:"p-4 space-y-3",children:(0,r.jsx)(F.N,{initial:!1,children:0===l.length?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,r.jsx)(v.A,{className:"w-8 h-8 text-gray-300 dark:text-zinc-600 mb-3"}),(0,r.jsx)("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"No activity yet"}),(0,r.jsx)("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1 max-w-[180px]",children:"Listening for new events..."})]}):l.map(e=>(0,r.jsxs)(I.P.div,{initial:{opacity:0,y:-10,scale:.98},animate:{opacity:1,y:0,scale:1},layout:!0,className:"bg-white dark:bg-zinc-900 border border-gray-200/50 dark:border-zinc-800 p-3 rounded-xl shadow-sm hover:shadow-md transition-all duration-200 group relative ".concat(e.is_stacked?"mb-2":""),children:[e.is_stacked&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"absolute top-1 left-2 right-2 h-full bg-white dark:bg-zinc-900 border border-gray-200/50 dark:border-zinc-800 rounded-xl z-[-1] scale-x-[0.96] translate-y-1 opacity-60"}),(0,r.jsx)("div",{className:"absolute top-2 left-4 right-4 h-full bg-white dark:bg-zinc-900 border border-gray-200/50 dark:border-zinc-800 rounded-xl z-[-2] scale-x-[0.92] translate-y-2 opacity-30"})]}),(0,r.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"text-xl shrink-0 mt-0.5 select-none grayscale group-hover:grayscale-0 transition-all duration-300",children:e.emoji}),e.is_stacked&&(0,r.jsxs)(b.E,{className:"absolute -bottom-2 -right-2 h-4 min-w-[1.25rem] px-1 flex items-center justify-center text-[9px] bg-gray-900 dark:bg-zinc-100 text-white dark:text-zinc-900 border-2 border-white dark:border-zinc-900 shadow-sm pointer-events-none",children:["x",e.stacked_count]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs font-semibold text-gray-800 dark:text-gray-200 leading-tight",children:e.event}),(0,r.jsxs)("div",{className:"flex items-center gap-2 mt-1.5",children:[(0,r.jsx)(b.E,{variant:"secondary",className:"text-[9px] h-4 px-1.5 rounded-md font-medium text-gray-500 bg-gray-100 dark:bg-zinc-800 dark:text-zinc-400 border-none",children:e.source}),"pending"===e.status&&(0,r.jsx)(b.E,{variant:"outline",className:"text-[9px] h-4 px-1.5 rounded-md text-amber-600 border-amber-200 bg-amber-50 dark:bg-amber-500/10 dark:border-amber-500/20",children:"Processing"}),"error"===e.status&&(0,r.jsx)(b.E,{variant:"destructive",className:"text-[9px] h-4 px-1.5 rounded-md",children:"Failed"}),e.category&&(0,r.jsx)(b.E,{variant:"outline",className:"text-[9px] h-4 px-1.5 rounded-md text-blue-600 border-blue-200 bg-blue-50 dark:bg-blue-500/10 dark:border-blue-500/20",children:(0,r.jsx)("span",{className:"truncate max-w-[80px]",children:e.category})}),e.is_stacked&&(0,r.jsx)("span",{className:"text-[9px] text-gray-400 italic",children:"Consolidated"})]})]})]}),(0,r.jsxs)("div",{className:"text-right shrink-0",children:[(0,r.jsx)(S.Bc,{children:(0,r.jsxs)(S.m_,{children:[(0,r.jsx)(S.k$,{asChild:!0,children:(0,r.jsx)("span",{className:"block text-[10px] font-medium text-gray-500 dark:text-zinc-400 cursor-help",children:u(e.timestamp)})}),(0,r.jsx)(S.ZI,{className:"z-[9999]",side:"top",children:(0,r.jsx)("p",{children:new Date(e.timestamp).toLocaleString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit",second:"2-digit"})})})]})}),(0,r.jsx)("span",{className:"text-[9px] text-gray-400 dark:text-zinc-600",children:function(e){let t=new Date(e.endsWith("Z")||e.includes("+")?e:e+"Z"),a=(new Date().getTime()-t.getTime())/1e3;return a<60?"Just now":a<3600?"".concat(Math.floor(a/60),"m ago"):a<86400?"".concat(Math.floor(a/3600),"h ago"):"".concat(Math.floor(a/86400),"d ago")}(e.timestamp)})]})]})]},e.id))})})})]})}var M=a(26336);let Z=e=>{var t,a,s;let{activeIntegration:n,companyId:i,open:o,isProcessingOrCoolingDown:d,isReconciling:c,isErrorState:x,isStuck:m,syncError:g,syncStats:u,onConnect:h,onTriggerReconciliation:p,isManualVerification:f=!1}=e;return(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("h4",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 flex items-center gap-2",children:[(0,r.jsx)(v.A,{className:"w-4 h-4 text-emerald-500"}),"Live Pulse"]}),(0,r.jsxs)(b.E,{variant:"outline",className:"text-[10px] h-5 gap-1 border-emerald-200/20 bg-emerald-500/5 text-emerald-600 dark:text-emerald-400",children:[(0,r.jsx)("div",{className:"w-1 h-1 rounded-full bg-emerald-500 animate-pulse"}),"Real-time"]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(y.$,{variant:"ghost",size:"sm",disabled:d,className:(0,l.cn)("h-7 px-2 text-[10px] gap-1.5 transition-all",m||x||g?"bg-red-50 hover:bg-red-100 dark:bg-red-500/10 dark:hover:bg-red-500/20 border-red-200 dark:border-red-500/20":d?"text-emerald-600 bg-emerald-50/50 dark:bg-emerald-900/10 dark:text-emerald-400 cursor-default":"text-gray-400 hover:text-emerald-500 hover:bg-emerald-50/50 dark:hover:bg-emerald-900/10 cursor-alias"),onClick:e=>{e.stopPropagation(),p()},children:d?(0,r.jsxs)(r.Fragment,{children:[c?(0,r.jsx)(E.A,{className:"w-3 h-3 animate-spin shrink-0"}):x?(0,r.jsx)(k.A,{className:"w-3 h-3 shrink-0 text-red-500"}):(0,r.jsx)(M.A,{className:"w-3 h-3 shrink-0 text-emerald-500"}),u.message?(0,r.jsxs)("div",{className:"flex items-center gap-2",children:["Integrity Verified"!==u.message||f?(0,r.jsx)("span",{className:"max-w-[140px] truncate text-[9px] font-medium opacity-90",children:u.message}):(0,r.jsx)("span",{className:"text-[10px] font-bold text-emerald-600 dark:text-emerald-400",children:"Excellent"}),u.message.toLowerCase().includes("reconnect")&&(0,r.jsx)("div",{className:"cursor-pointer hover:underline text-[9px] font-bold text-emerald-600 dark:text-emerald-400",onClick:e=>{e.stopPropagation(),h("shopify")},children:"Fix Now"})]}):"Verifying..."]}):(0,r.jsx)(r.Fragment,{children:(null===(s=n.metadata_info)||void 0===s?void 0:null===(a=s.sync_stats)||void 0===a?void 0:null===(t=a.message)||void 0===t?void 0:t.toLowerCase().includes("reconnect"))?(0,r.jsxs)("div",{className:"flex items-center gap-1.5 text-amber-600 dark:text-amber-500 font-bold",onClick:e=>{e.stopPropagation(),h("shopify")},children:[(0,r.jsx)(j.A,{className:"w-3 h-3"}),"Fix Connection"]}):(0,r.jsx)(r.Fragment,{children:m||x||g?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(j.A,{className:"w-3 h-3 text-red-500"}),(0,r.jsx)("span",{className:"text-red-600 dark:text-red-400 font-bold",children:"Retry Verification"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(w.A,{className:"w-3 h-3"}),"Verify Integrity"]})})})}),(0,r.jsx)(S.Bc,{delayDuration:0,children:(0,r.jsxs)(S.m_,{children:[(0,r.jsx)(S.k$,{asChild:!0,children:(0,r.jsx)("div",{className:"cursor-help p-1 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors opacity-50 hover:opacity-100",children:(0,r.jsx)(k.A,{className:"w-3 h-3 text-gray-400 dark:text-zinc-500"})})}),(0,r.jsxs)(S.ZI,{side:"bottom",className:"max-w-[260px] p-0 overflow-hidden bg-zinc-900/95 dark:bg-zinc-950/95 backdrop-blur-xl border border-zinc-800 ring-1 ring-white/10 shadow-[0_10px_40px_-10px_rgba(0,0,0,0.5)] rounded-xl animate-in fade-in zoom-in-95 slide-in-from-top-2 duration-200",children:[(0,r.jsx)("div",{className:"px-4 py-3 border-b border-zinc-800/50 bg-gradient-to-b from-white/5 to-transparent",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-1.5 h-1.5 rounded-full bg-emerald-500 shadow-[0_0_8px_rgba(16,185,129,0.5)]"}),(0,r.jsx)("span",{className:"font-bold text-[10px] text-zinc-400 uppercase tracking-widest",children:g?"Network Error":"Data Integrity Guard"})]})}),(0,r.jsx)("div",{className:"px-4 py-3",children:(0,r.jsx)("p",{className:"text-xs font-medium text-zinc-300 leading-relaxed",children:g?"Could not fetch integration status. Click to refresh the connection.":'Triggers a deep "Zero-Drift" audit to guarantee 100% data match with Shopify.'})})]})]})})]})]}),c&&!m&&void 0!==u.progress&&(0,r.jsx)("div",{className:"w-full h-1 bg-gray-100 dark:bg-zinc-800 rounded-full overflow-hidden mb-3",children:(0,r.jsx)("div",{className:"h-full bg-emerald-500 transition-all duration-500 ease-out",style:{width:"".concat(u.progress,"%")}})}),(0,r.jsx)("div",{className:"min-h-[200px] border border-gray-100 dark:border-zinc-800 rounded-lg bg-gray-50/50 dark:bg-zinc-900/50 overflow-hidden",children:(0,r.jsx)(W,{integrationId:n.id,open:o,companyId:i||void 0,onSyncTriggered:()=>{}})})]})};var V=a(87385),$=a(39196),X=a(78831),Y=a(7837),J=a(72309);function G(e){let{isOpen:t,onClose:a,reconciledCount:s=0}=e;return(0,r.jsx)(Y.lG,{open:t,onOpenChange:a,children:(0,r.jsxs)(Y.Cf,{className:"sm:max-w-[440px] border-emerald-200 dark:border-emerald-900/30 bg-white dark:bg-zinc-950 p-0 overflow-hidden rounded-3xl shadow-2xl",children:[(0,r.jsxs)(J.s,{children:[(0,r.jsx)(Y.L3,{children:"Integrity Verification Complete"}),(0,r.jsx)(Y.rr,{children:"Your data integrity has been verified and zero-drift confirmed."})]}),(0,r.jsx)(F.N,{children:t&&(0,r.jsxs)(I.P.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:1.05},className:"p-12 flex flex-col items-center text-center space-y-6",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)(I.P.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.1,type:"spring",stiffness:200,damping:15},className:"w-24 h-24 rounded-full bg-emerald-500/10 flex items-center justify-center relative",children:[(0,r.jsx)(w.A,{className:"w-12 h-12 text-emerald-600 dark:text-emerald-500",strokeWidth:2}),(0,r.jsx)(I.P.div,{initial:{scale:1,opacity:.5},animate:{scale:1.5,opacity:0},transition:{duration:2,repeat:1/0},className:"absolute inset-0 rounded-full border-2 border-emerald-500"})]}),(0,r.jsx)(I.P.div,{initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},transition:{delay:.3,duration:.4},className:"absolute -top-2 -right-2",children:(0,r.jsx)(N.A,{className:"w-6 h-6 text-emerald-500",fill:"currentColor"})}),(0,r.jsx)(I.P.div,{initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},transition:{delay:.4,duration:.4},className:"absolute -bottom-2 -left-2",children:(0,r.jsx)(N.A,{className:"w-5 h-5 text-emerald-400",fill:"currentColor"})})]}),(0,r.jsxs)(I.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2,duration:.4},className:"space-y-2",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-zinc-900 dark:text-zinc-100",children:"Integrity Verified!"}),(0,r.jsxs)("p",{className:"text-sm text-zinc-600 dark:text-zinc-400 max-w-xs mx-auto leading-relaxed",children:[(0,r.jsx)("span",{className:"font-semibold text-emerald-600 dark:text-emerald-500",children:"100% Match Confirmed."}),(0,r.jsx)("br",{}),"We audited your Orders and Products against Shopify and found Zero Drift."]})]}),(0,r.jsx)(I.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.4},className:"w-full pt-2",children:(0,r.jsx)(y.$,{onClick:a,className:"w-full h-11 bg-emerald-600 hover:bg-emerald-700 text-white font-bold rounded-xl shadow-lg shadow-emerald-500/20 transition-all hover:scale-[1.02] active:scale-[0.98]",children:"Excellent"})}),(0,r.jsx)("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-emerald-400 via-emerald-500 to-emerald-600"})]})})]})})}let H=e=>{var t,n,i,o,c,x;let{integration:m,open:F,onOpenChange:I,onSync:D,onDisconnect:E,onConnect:P,onRefresh:T}=e,{companyId:L}=(0,$.A)(),[O,U]=s.useState(!1),B=s.useRef(m);m&&(B.current=m);let W=m||B.current,{data:M,error:Y,isValidating:J,mutate:H}=(0,V.Ay)(F&&(null==W?void 0:W.id)?["/api/v1/integrations/".concat(W.id),L]:null,()=>W?(0,X.getIntegration)(L,W.id):null,{refreshInterval:1e3,dedupingInterval:500,revalidateOnFocus:!0,revalidateOnReconnect:!0,shouldRetryOnError:!0}),[q,K]=s.useState(null),[Q,ee]=s.useState(null),et=s.useRef(null),ea=s.useRef(null),[er,es]=s.useState(!1),en=M||W,ei=(null==en?void 0:null===(t=en.metadata_info)||void 0===t?void 0:t.sync_stats)||{},eo="reconciling"===ei.current_step,el="complete"===ei.current_step&&"Integrity Verified"===ei.message,ed="error"===ei.current_step,ec=(null==en?void 0:en.status)==="active",ex=(null==en?void 0:en.status)==="syncing"||(null==en?void 0:en.status)==="SYNCING",em=s.useCallback(e=>{if(!e)return 0;try{let t=e.endsWith("Z")||e.includes("+")?e:e+"Z";return new Date(t).getTime()}catch(e){return 0}},[]);if(s.useEffect(()=>{(el||ed)&&!q&&(K(Date.now()),ee(null)),eo&&(K(null),Q||ee(Date.now()))},[el,ed,eo,q,Q]),s.useEffect(()=>{F&&(null==en?void 0:en.id)&&ec&&!ex&&!eo&&ea.current!==en.id&&(console.log("[Drawer] Auto-triggering integrity check for ".concat(en.id)),ea.current=en.id,es(!1),Promise.resolve().then(a.bind(a,78831)).then(e=>{let{verifyIntegrationIntegrity:t}=e;t(L,en.id).then(()=>H()).catch(e=>console.error("[Drawer] Auto-sync failed:",e))})),F||(ea.current=null)},[F,null==en?void 0:en.id,ec,ex,eo,L,H]),s.useEffect(()=>{if(el){let e=ei.last_updated||"";if(e&&et.current!==e){let t=em(ei.last_updated);Date.now()-t<15e3&&er&&(et.current=e,U(!0))}}},[el,ei.last_updated,er,em,U]),!W||!en)return null;let eg="error"===(M||W).status,eu=ec||ex||eg,eh=q?Date.now()-q:99999,ep=Q&&Date.now()-Q>3e5,ef=eo&&!ep||null!==q&&eh<3e3;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(G,{isOpen:O,onClose:()=>U(!1)}),(0,r.jsx)(d,{open:F,onOpenChange:I,children:(0,r.jsxs)(g,{side:"right",className:"sm:max-w-md border-l border-gray-100 dark:border-zinc-800 bg-white/95 dark:bg-zinc-950/95 backdrop-blur-xl p-0 flex flex-col",children:[(0,r.jsxs)(u,{className:"p-6 border-b border-gray-100 dark:border-zinc-900 text-left",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,r.jsx)("div",{className:"w-12 h-12 rounded-xl bg-white dark:bg-zinc-900 border border-gray-100 dark:border-zinc-800 flex items-center justify-center p-2 shadow-sm overflow-hidden",children:W.datasource.logo_url?(0,r.jsx)("img",{src:W.datasource.logo_url,alt:W.datasource.name,className:"w-full h-full object-contain"}):(0,r.jsx)("div",{className:"w-full h-full bg-orange-500/10 flex items-center justify-center text-orange-500 font-bold",children:W.datasource.name[0]})}),(0,r.jsxs)("div",{children:[(0,r.jsx)(p,{className:"text-xl font-bold dark:text-zinc-100",children:W.datasource.name}),(0,r.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,r.jsxs)(b.E,{variant:"outline",className:(0,l.cn)("text-[10px] py-0 px-2 flex items-center gap-1 relative overflow-hidden",ec?"bg-emerald-500/5 border-emerald-500/10 text-emerald-500":"bg-zinc-100 dark:bg-zinc-800 border-zinc-200 dark:border-zinc-700 text-zinc-500"),children:[eu&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:(0,l.cn)("w-1.5 h-1.5 rounded-full mr-0.5",ec?"bg-emerald-500 animate-pulse":ex?"bg-blue-500 animate-spin":"bg-red-500")}),ec&&(0,r.jsx)("div",{className:"absolute top-1/2 left-2 -translate-y-1/2 w-1.5 h-1.5 rounded-full bg-emerald-400 animate-ping opacity-75"})]}),!eu&&(0,r.jsx)(v.A,{className:"w-2.5 h-2.5"}),ec?"Healthy":ex?"Syncing...":eg?"Connection Error":"Not Connected"]}),eg&&(0,r.jsxs)("button",{onClick:()=>m&&P(m.datasource.slug),className:"text-[10px] font-bold text-red-500 hover:text-red-600 dark:hover:text-red-400 transition-colors flex items-center gap-1.5 px-1.5 py-0.5 rounded-md hover:bg-red-50 dark:hover:bg-red-500/10",children:[(0,r.jsx)(j.A,{className:"w-3 h-3"}),"Reconnect"]}),(0,r.jsx)("span",{className:"text-[10px] text-gray-400 dark:text-zinc-500",children:"•"}),(0,r.jsx)("span",{className:"text-[10px] text-gray-400 dark:text-zinc-500 font-medium",children:"Read-only"})]})]})]}),(0,r.jsx)("div",{className:"mt-1",children:(null===(n=W.metadata_info)||void 0===n?void 0:n.shop)?(0,r.jsxs)("div",{className:"inline-flex items-center gap-3 px-3 py-1.5 rounded-lg bg-gray-50 dark:bg-zinc-900 border border-gray-100 dark:border-zinc-800",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"flex items-center justify-center w-5 h-5 rounded-full bg-[#95BF47]/10 dark:bg-[#95BF47]/20",children:(0,r.jsx)(w.A,{className:"w-3 h-3 text-[#95BF47]"})}),(0,r.jsxs)("span",{className:"text-xs font-medium text-gray-600 dark:text-zinc-300",children:["Connected to ",(0,r.jsx)("span",{className:"font-bold text-gray-900 dark:text-white",children:W.metadata_info.shop.replace(".myshopify.com","")})]})]}),(0,r.jsx)("div",{className:"h-3 w-px bg-gray-200 dark:bg-zinc-700"}),(0,r.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,r.jsxs)("div",{className:"relative flex h-2 w-2",children:[(0,r.jsx)("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"}),(0,r.jsx)("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-emerald-500"})]}),(0,r.jsx)("span",{className:"text-[10px] font-bold uppercase tracking-wider text-emerald-600 dark:text-emerald-500",children:"Secure"})]})]}):(0,r.jsx)(f,{className:"text-zinc-500 dark:text-zinc-400 leading-relaxed text-sm",children:W.datasource.description||"Securely connected to ".concat(W.datasource.name,". We only fetch what's necessary to compute your metrics.")})})]}),(0,r.jsxs)("div",{className:"flex-1 overflow-y-auto p-6 space-y-8",children:[!ec&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("h4",{className:"text-xs font-bold text-gray-400 dark:text-zinc-500 tracking-wider uppercase flex items-center gap-2",children:[(0,r.jsx)(N.A,{className:"w-3.5 h-3.5 text-orange-400"}),"What you get"]}),(0,r.jsxs)("div",{className:"grid gap-3",children:[(0,r.jsxs)("div",{className:"p-3 rounded-xl bg-orange-500/5 border border-orange-500/10 flex items-start gap-3",children:[(0,r.jsx)("div",{className:"mt-1 w-1.5 h-1.5 rounded-full bg-orange-500 shrink-0"}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("div",{className:"text-xs font-bold text-gray-900 dark:text-zinc-100",children:"Automated Profit Analytics"}),(0,r.jsx)("p",{className:"text-[11px] text-gray-500 dark:text-zinc-400 leading-relaxed",children:"We'll automatically fetch orders, fees, and payouts to calculate your true net profit."})]})]}),(0,r.jsxs)("div",{className:"p-3 rounded-xl bg-blue-500/5 border border-blue-500/10 flex items-start gap-3",children:[(0,r.jsx)("div",{className:"mt-1 w-1.5 h-1.5 rounded-full bg-blue-500 shrink-0"}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("div",{className:"text-xs font-bold text-gray-900 dark:text-zinc-100",children:"Historical Sync"}),(0,r.jsx)("p",{className:"text-[11px] text-gray-500 dark:text-zinc-400 leading-relaxed",children:"We backfill up to 12 months of data to give you instant historical context."})]})]})]})]}),eu&&(0,r.jsxs)("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-2 duration-500",children:[(0,r.jsx)(R,{status:en.status,lastSynced:en.last_sync_at||void 0,syncStats:null===(i=en.metadata_info)||void 0===i?void 0:i.sync_stats,onSync:()=>D(en.id)}),(null===(o=en.metadata_info)||void 0===o?void 0:o.sync_stats)&&(0,r.jsx)("div",{className:"grid grid-cols-3 gap-2",children:[{label:"Orders",key:"orders_count",tooltip:"Includes all orders (open, archived, cancelled) from all sales channels."},{label:"Products",key:"products_count",tooltip:"Total count of products (Active + Draft/Archived)."},{label:"Inventory",key:"inventory_count",tooltip:"Total available stock across all tracked inventory items and locations."}].map((e,t)=>{var a,s,n,i;let o=2===t;return(0,r.jsxs)("div",{className:"p-3 rounded-xl bg-gray-50/50 dark:bg-zinc-900/50 border border-gray-100 dark:border-zinc-800 transition-all hover:bg-gray-50 dark:hover:bg-zinc-900 group",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1.5 mb-1.5",children:[(0,r.jsx)("div",{className:"text-[9px] font-bold text-gray-400 dark:text-zinc-500 uppercase tracking-widest whitespace-nowrap",children:e.label}),e.tooltip&&(0,r.jsx)(S.Bc,{delayDuration:0,children:(0,r.jsxs)(S.m_,{children:[(0,r.jsx)(S.k$,{asChild:!0,children:(0,r.jsx)("div",{className:"group/info cursor-help p-0.5 -m-0.5 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors relative",children:(0,r.jsx)(k.A,{className:"w-2.5 h-2.5 text-gray-300 dark:text-zinc-600 group-hover/info:text-[#FF8A4C] transition-colors"})})}),(0,r.jsxs)(S.ZI,{side:o?"left":"bottom",className:(0,l.cn)("max-w-[240px] p-0 overflow-hidden bg-zinc-900/95 dark:bg-zinc-950/95 backdrop-blur-xl border border-zinc-800 ring-1 ring-white/10 shadow-[0_10px_40px_-10px_rgba(0,0,0,0.5)] rounded-xl animate-in fade-in zoom-in-95 duration-200",o?"slide-in-from-right-2 origin-right":"slide-in-from-top-1 origin-top"),children:[(0,r.jsx)("div",{className:"px-4 py-3 border-b border-zinc-800/50 bg-gradient-to-b from-white/5 to-transparent",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-1.5 h-1.5 rounded-full bg-[#FF8A4C] shadow-[0_0_8px_rgba(255,138,76,0.5)]"}),(0,r.jsx)("span",{className:"font-bold text-[10px] text-zinc-400 uppercase tracking-widest",children:"Calculation"})]})}),(0,r.jsx)("div",{className:"px-4 py-3",children:(0,r.jsx)("p",{className:"text-xs font-medium text-zinc-300 leading-relaxed",children:e.tooltip})})]})]})})]}),(0,r.jsx)("div",{className:"text-sm font-bold text-gray-900 dark:text-zinc-100 tabular-nums",children:new Intl.NumberFormat("en-US",{notation:(null===(s=en.metadata_info)||void 0===s?void 0:null===(a=s.sync_stats)||void 0===a?void 0:a[e.key])>9999?"compact":"standard",maximumFractionDigits:1}).format((null===(i=en.metadata_info)||void 0===i?void 0:null===(n=i.sync_stats)||void 0===n?void 0:n[e.key])||0)})]},e.key)})}),(null===(x=en.metadata_info)||void 0===x?void 0:null===(c=x.sync_stats)||void 0===c?void 0:c.last_updated)&&(0,r.jsxs)("div",{className:"flex items-center justify-end gap-1.5 mt-2 pr-1",children:[(0,r.jsx)("div",{className:"w-1.5 h-1.5 rounded-full bg-emerald-500/50 animate-pulse"}),(0,r.jsxs)("span",{className:"text-[10px] font-medium text-gray-400 dark:text-zinc-500 uppercase tracking-wide",children:["Last ","Integrity Verified"===ei.message?"Verified":"Updated",": ",(e=>{if(!e)return"Never";try{let t=e.endsWith("Z")||e.includes("+")?e:e+"Z",a=new Date(t),r=(new Date().getTime()-a.getTime())/1e3;if(r<30)return"Just now";if(r<3600)return"".concat(Math.floor(r/60),"m ago");if(r<86400)return"".concat(Math.floor(r/3600),"h ago");return"".concat(Math.floor(r/86400),"d ago")}catch(e){return"Unknown"}})(en.metadata_info.sync_stats.last_updated)]})]}),(0,r.jsx)(Z,{activeIntegration:en,companyId:L||null,open:F,isProcessingOrCoolingDown:ef,isManualVerification:er,isReconciling:eo,isErrorState:ed,isStuck:ep||!1,syncError:Y,syncStats:ei,onConnect:P,onTriggerReconciliation:()=>{var e,t,r;if(null===(r=en.metadata_info)||void 0===r?void 0:null===(t=r.sync_stats)||void 0===t?void 0:null===(e=t.message)||void 0===e?void 0:e.toLowerCase().includes("reconnect")){P("shopify");return}L&&(null==en?void 0:en.id)&&(es(!0),H(),Promise.resolve().then(a.bind(a,78831)).then(e=>{let{verifyIntegrationIntegrity:t}=e;t(L,en.id).then(()=>H()).catch(e=>console.error(e))}))}})]}),!eu&&(0,r.jsxs)("div",{className:"space-y-8",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("h4",{className:"text-xs font-bold text-gray-400 dark:text-zinc-500 tracking-wider uppercase flex items-center gap-2",children:[(0,r.jsx)(z.A,{className:"w-3.5 h-3.5"}),"Data Safety & Privacy"]}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex gap-4 p-4 rounded-2xl bg-emerald-500/5 border border-emerald-500/10",children:[(0,r.jsx)(_.A,{className:"w-5 h-5 text-emerald-500 shrink-0 mt-0.5"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-xs font-bold text-emerald-600 dark:text-emerald-500 uppercase tracking-tight",children:"Read-Only Access"}),(0,r.jsx)("div",{className:"text-[11px] text-emerald-600/70 dark:text-emerald-500/60 mt-0.5 leading-normal",children:"We never modify your data. We only read what's necessary to compute unit economics."})]})]}),(0,r.jsxs)("div",{className:"flex gap-4 p-4 rounded-2xl bg-orange-500/5 border border-orange-500/10",children:[(0,r.jsx)(C.A,{className:"w-5 h-5 text-orange-500 shrink-0 mt-0.5"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-xs font-bold text-orange-600 dark:text-orange-500 uppercase tracking-tight",children:"Encrypted at Rest"}),(0,r.jsx)("div",{className:"text-[11px] text-orange-600/70 dark:text-orange-500/60 mt-0.5 leading-normal",children:"All connection credentials are encrypted using industry-standard AES-256."})]})]})]})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("h4",{className:"text-xs font-bold text-gray-400 dark:text-zinc-500 tracking-wider uppercase flex items-center gap-2",children:[(0,r.jsx)(k.A,{className:"w-3.5 h-3.5"}),"Data we access"]}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:["Orders","Payments","Taxes","Discounts","Inventory","Customers"].map(e=>(0,r.jsx)(b.E,{variant:"outline",className:"bg-gray-50/50 dark:bg-zinc-900 border-gray-100 dark:border-zinc-800 text-gray-600 dark:text-zinc-400 text-[10px] py-1 px-3",children:e},e))})]})]})]}),(0,r.jsxs)(h,{className:"p-6 border-t border-gray-100 dark:border-zinc-900 space-y-3 sm:flex-col",children:[(0,r.jsx)("div",{className:"text-[11px] text-gray-400 dark:text-zinc-500 italic text-center w-full mb-2",children:"Connected through secure API connector. Unclutr is SOC 2 compliant."}),eu?(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)(y.$,{variant:"outline",className:"w-full h-11 border-gray-200 dark:border-zinc-800 text-gray-600 dark:text-zinc-400 font-bold text-sm rounded-xl hover:bg-gray-50 dark:hover:bg-zinc-900 transition-all flex items-center justify-center gap-2",onClick:()=>{window.__clearActivityFeed&&window.__clearActivityFeed(),D(W.id)},children:[(0,r.jsx)(j.A,{className:"w-4 h-4"}),"Sync Data Now"]}),(0,r.jsxs)(y.$,{variant:"outline",className:"w-full h-11 transition-all text-xs font-bold flex items-center justify-center gap-2 border-red-500/10 text-red-500 hover:bg-red-500/5 hover:border-red-500/20",onClick:()=>E(W.id),children:[(0,r.jsx)(A.A,{className:"w-4 h-4"}),"Request Disconnection"]})]}):(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)(y.$,{className:"w-full h-11 bg-[#FF8A4C] hover:bg-[#FF8A4C]/90 text-white font-bold text-sm rounded-xl shadow-lg shadow-orange-500/20",onClick:()=>{P(W.datasource.slug)},children:["Connect ",W.datasource.name]}),(0,r.jsxs)(y.$,{variant:"outline",className:"w-full h-11 border-gray-200 dark:border-zinc-800 text-gray-500 dark:text-zinc-400 hover:bg-gray-100 dark:hover:bg-zinc-900 text-xs font-bold",onClick:()=>E(W.id),children:[(0,r.jsx)(A.A,{className:"w-4 h-4 mr-2"}),"Remove from Stack"]})]})]})]})})]})}},18064:(e,t,a)=>{a.d(t,{X:()=>o});var r=a(95155);a(12115);var s=a(39286),n=a(15205),i=a(48686);function o(){return(0,r.jsxs)("div",{className:"relative group w-full max-w-2xl mx-auto",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-orange-500/10 to-orange-600/5 blur-[40px] rounded-[32px] transform scale-95 opacity-50 group-hover:opacity-75 transition-opacity duration-700 pointer-events-none"}),(0,r.jsxs)("div",{className:"relative rounded-[24px] border border-gray-100 dark:border-white/[0.08] bg-white/60 dark:bg-zinc-900/40 backdrop-blur-xl shadow-[0_8px_30px_rgb(0,0,0,0.04)] dark:shadow-[0_8px_30px_rgb(0,0,0,0.2)] overflow-hidden p-8 sm:p-12 text-center flex flex-col items-center justify-center",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-[linear-gradient(to_right,#80808012_1px,transparent_1px),linear-gradient(to_bottom,#80808012_1px,transparent_1px)] bg-[size:24px_24px] [mask-image:radial-gradient(ellipse_60%_50%_at_50%_40%,#000_20%,transparent_100%)] pointer-events-none"}),(0,r.jsxs)("div",{className:"relative z-10 flex flex-col items-center gap-6",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-orange-500/20 blur-xl rounded-full"}),(0,r.jsx)("div",{className:"relative w-16 h-16 rounded-2xl bg-gradient-to-br from-white to-gray-50 dark:from-zinc-800 dark:to-zinc-900 shadow-lg border border-white/50 dark:border-white/10 flex items-center justify-center",children:(0,r.jsx)(n.A,{className:"w-8 h-8 text-orange-500 transform -rotate-45",strokeWidth:1.5})})]}),(0,r.jsx)(s.E,{variant:"outline",className:"bg-orange-50/50 dark:bg-orange-900/10 border-orange-200 dark:border-orange-500/20 text-orange-600 dark:text-orange-400 font-bold tracking-widest text-[10px] px-3 py-1 uppercase rounded-full",children:"Coming Soon"}),(0,r.jsxs)("div",{className:"space-y-3 max-w-md",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white tracking-tight",children:"Integrations"}),(0,r.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-base leading-relaxed font-medium",children:"We’re polishing secure connectors for your business stack. You’ll see them here soon."})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3 mt-4 opacity-50 grayscale select-none pointer-events-none",children:[(0,r.jsx)("div",{className:"w-10 h-10 rounded-xl bg-gray-100 dark:bg-zinc-800 border border-dashed border-gray-300 dark:border-zinc-700 flex items-center justify-center",children:(0,r.jsx)("div",{className:"w-4 h-4 rounded-md bg-gray-200 dark:bg-zinc-700"})}),(0,r.jsx)("div",{className:"w-8 h-[1px] bg-gradient-to-r from-gray-300 to-gray-300 dark:from-zinc-700 dark:to-zinc-700"}),(0,r.jsx)("div",{className:"w-10 h-10 rounded-xl bg-gray-100 dark:bg-zinc-800 border border-gray-200 dark:border-zinc-700 flex items-center justify-center shadow-sm",children:(0,r.jsx)(i.A,{className:"w-4 h-4 text-gray-400 dark:text-zinc-600"})}),(0,r.jsx)("div",{className:"w-8 h-[1px] bg-gradient-to-r from-gray-300 to-gray-300 dark:from-zinc-700 dark:to-zinc-700"}),(0,r.jsx)("div",{className:"w-10 h-10 rounded-xl bg-gray-100 dark:bg-zinc-800 border border-dashed border-gray-300 dark:border-zinc-700 flex items-center justify-center",children:(0,r.jsx)("div",{className:"w-4 h-4 rounded-md bg-gray-200 dark:bg-zinc-700"})})]})]})]})]})}},50234:(e,t,a)=>{a.d(t,{p:()=>m});var r=a(95155),s=a(12115),n=a(28633),i=a(71226),o=a(7837),l=a(26336),d=a(30098),c=a(14085),x=a(72309);function m(e){let{isOpen:t,onClose:a,shopName:m}=e,[g,u]=(0,s.useState)(3);return(0,s.useEffect)(()=>{if(!t){u(3);return}let e=setInterval(()=>{u(t=>t<=1?(clearInterval(e),a(),0):t-1)},1e3);return()=>clearInterval(e)},[t,a]),(0,r.jsx)(o.lG,{open:t,onOpenChange:a,children:(0,r.jsxs)(o.Cf,{className:"sm:max-w-[440px] border-emerald-200 dark:border-emerald-900/30 bg-white dark:bg-zinc-950 p-0 overflow-hidden rounded-3xl shadow-2xl",children:[(0,r.jsxs)(x.s,{children:[(0,r.jsx)(o.L3,{children:"Store Connected Successfully"}),(0,r.jsx)(o.rr,{children:"Your Shopify store has been successfully connected and data synchronization has started."})]}),(0,r.jsx)(n.N,{children:t&&(0,r.jsxs)(i.P.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:1.05},className:"p-12 flex flex-col items-center text-center space-y-6",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)(i.P.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.1,type:"spring",stiffness:200,damping:15},className:"w-24 h-24 rounded-full bg-emerald-500/10 flex items-center justify-center relative",children:[(0,r.jsx)(l.A,{className:"w-12 h-12 text-emerald-600 dark:text-emerald-500",strokeWidth:2}),(0,r.jsx)(i.P.div,{initial:{scale:1,opacity:.5},animate:{scale:1.5,opacity:0},transition:{duration:1.5,repeat:1/0},className:"absolute inset-0 rounded-full border-2 border-emerald-500"})]}),(0,r.jsx)(i.P.div,{initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},transition:{delay:.3,duration:.4},className:"absolute -top-2 -right-2",children:(0,r.jsx)(d.A,{className:"w-6 h-6 text-emerald-500",fill:"currentColor"})}),(0,r.jsx)(i.P.div,{initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},transition:{delay:.4,duration:.4},className:"absolute -bottom-2 -left-2",children:(0,r.jsx)(d.A,{className:"w-5 h-5 text-emerald-400",fill:"currentColor"})})]}),(0,r.jsxs)(i.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2,duration:.4},className:"space-y-2",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-zinc-900 dark:text-zinc-100",children:"Store Connected!"}),(0,r.jsx)("p",{className:"text-sm text-zinc-600 dark:text-zinc-400 max-w-xs mx-auto",children:m?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"font-semibold text-emerald-600 dark:text-emerald-500",children:m})," ","is now syncing with Unclutr. Initial data sync is in motion."]}):"Your Shopify store is now syncing with Unclutr. Initial data sync is in motion."})]}),(0,r.jsxs)(i.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.4},className:"w-full space-y-3",children:[(0,r.jsxs)("div",{className:"text-xs font-medium text-zinc-500 dark:text-zinc-400",children:["Redirecting in ",g,"s..."]}),(0,r.jsx)(c.$,{onClick:a,className:"w-full h-11 bg-emerald-600 hover:bg-emerald-700 text-white font-bold rounded-xl shadow-lg shadow-emerald-500/20 transition-all hover:scale-[1.02] active:scale-[0.98]",children:"Go to Dashboard"})]}),(0,r.jsx)("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-emerald-400 via-emerald-500 to-emerald-600"})]})})]})})}},25858:(e,t,a)=>{a.d(t,{$v:()=>p,EO:()=>m,Lt:()=>l,Rx:()=>f,Zr:()=>b,ck:()=>u,r7:()=>h,tv:()=>d,wd:()=>g});var r=a(95155),s=a(12115),n=a(63985),i=a(29602),o=a(14085);let l=n.bL,d=n.l9,c=n.ZL,x=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.hJ,{className:(0,i.cn)("fixed inset-0 z-50 bg-black/20 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...s,ref:t})});x.displayName=n.hJ.displayName;let m=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsxs)(c,{children:[(0,r.jsx)(x,{}),(0,r.jsx)(n.UC,{ref:t,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...s})]})});m.displayName=n.UC.displayName;let g=e=>{let{className:t,...a}=e;return(0,r.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...a})};g.displayName="AlertDialogHeader";let u=e=>{let{className:t,...a}=e;return(0,r.jsx)("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};u.displayName="AlertDialogFooter";let h=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.hE,{ref:t,className:(0,i.cn)("text-lg font-semibold",a),...s})});h.displayName=n.hE.displayName;let p=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.VY,{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",a),...s})});p.displayName=n.VY.displayName;let f=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.rc,{ref:t,className:(0,i.cn)((0,o.r)(),a),...s})});f.displayName=n.rc.displayName;let b=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.ZD,{ref:t,className:(0,i.cn)((0,o.r)({variant:"outline"}),"mt-2 sm:mt-0",a),...s})});b.displayName=n.ZD.displayName},39286:(e,t,a)=>{a.d(t,{E:()=>o});var r=a(95155);a(12115);var s=a(31027),n=a(29602);let i=(0,s.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function o(e){let{className:t,variant:a,...s}=e;return(0,r.jsx)("div",{className:(0,n.cn)(i({variant:a}),t),...s})}},14085:(e,t,a)=>{a.d(t,{$:()=>d,r:()=>l});var r=a(95155),s=a(12115),n=a(12317),i=a(31027),o=a(29602);let l=(0,i.F)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 shadow-sm",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90 shadow-sm",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground transition-all active:scale-[0.98]",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=s.forwardRef((e,t)=>{let{className:a,variant:s,size:i,asChild:d=!1,...c}=e,x=d?n.DX:"button";return(0,r.jsx)(x,{className:(0,o.cn)(l({variant:s,size:i,className:a})),ref:t,...c})});d.displayName="Button"},35007:(e,t,a)=>{a.d(t,{BT:()=>d,Wu:()=>c,ZB:()=>l,Zp:()=>i,aR:()=>o});var r=a(95155),s=a(12115),n=a(29602);let i=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("rounded-xl border bg-card text-card-foreground",a),...s})});i.displayName="Card";let o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",a),...s})});o.displayName="CardHeader";let l=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("h3",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",a),...s})});l.displayName="CardTitle";let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",a),...s})});d.displayName="CardDescription";let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",a),...s})});c.displayName="CardContent",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",a),...s})}).displayName="CardFooter"},7837:(e,t,a)=>{a.d(t,{Cf:()=>x,L3:()=>g,c7:()=>m,lG:()=>l,rr:()=>u});var r=a(95155),s=a(12115),n=a(30042),i=a(40767),o=a(29602);let l=n.bL;n.l9;let d=n.ZL;n.bm;let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.hJ,{ref:t,className:(0,o.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...s})});c.displayName=n.hJ.displayName;let x=s.forwardRef((e,t)=>{let{className:a,children:s,...l}=e;return(0,r.jsxs)(d,{children:[(0,r.jsx)(c,{}),(0,r.jsxs)(n.UC,{ref:t,className:(0,o.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...l,children:[s,(0,r.jsxs)(n.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,r.jsx)(i.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});x.displayName=n.UC.displayName;let m=e=>{let{className:t,...a}=e;return(0,r.jsx)("div",{className:(0,o.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};m.displayName="DialogHeader";let g=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.hE,{ref:t,className:(0,o.cn)("text-lg font-semibold leading-none tracking-tight",a),...s})});g.displayName=n.hE.displayName;let u=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.VY,{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",a),...s})});u.displayName=n.VY.displayName},9955:(e,t,a)=>{a.d(t,{p:()=>i});var r=a(95155),s=a(12115),n=a(29602);let i=s.forwardRef((e,t)=>{let{className:a,type:s,...i}=e;return(0,r.jsx)("input",{type:s,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...i})});i.displayName="Input"},3392:(e,t,a)=>{a.d(t,{F:()=>o});var r=a(95155),s=a(12115),n=a(21868),i=a(29602);let o=s.forwardRef((e,t)=>{let{className:a,children:s,...o}=e;return(0,r.jsxs)(n.bL,{ref:t,className:(0,i.cn)("relative overflow-hidden",a),...o,children:[(0,r.jsx)(n.LM,{className:"h-full w-full rounded-[inherit]",children:s}),(0,r.jsx)(l,{}),(0,r.jsx)(n.OK,{})]})});o.displayName=n.bL.displayName;let l=s.forwardRef((e,t)=>{let{className:a,orientation:s="vertical",...o}=e;return(0,r.jsx)(n.VM,{ref:t,orientation:s,className:(0,i.cn)("flex touch-none select-none transition-colors","vertical"===s&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===s&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",a),...o,children:(0,r.jsx)(n.lr,{className:"relative flex-1 rounded-full bg-border"})})});l.displayName=n.VM.displayName},9246:(e,t,a)=>{a.d(t,{Bc:()=>d,ZI:()=>m,k$:()=>x,m_:()=>c});var r=a(95155),s=a(12115),n=a(47650),i=a(28633),o=a(71226);let l=s.createContext(null),d=e=>{let{children:t,delayDuration:a=200}=e;return(0,r.jsx)(r.Fragment,{children:t})},c=e=>{let{children:t}=e,[a,n]=s.useState(!1),i=s.useRef(null);return(0,r.jsx)(l.Provider,{value:{isOpen:a,setIsOpen:n,triggerRef:i},children:(0,r.jsx)("div",{className:"relative inline-block",onMouseLeave:()=>n(!1),children:t})})},x=e=>{let{children:t,asChild:a=!1}=e,n=s.useContext(l);if(!n)throw Error("TooltipTrigger must be used within a Tooltip");let i=s.Children.only(t);return s.isValidElement(i)?s.cloneElement(i,{ref:e=>{n.triggerRef.current=e;let{ref:t}=i;"function"==typeof t?t(e):t&&(t.current=e)},onMouseEnter:e=>{var t,a;n.setIsOpen(!0),null===(t=(a=i.props).onMouseEnter)||void 0===t||t.call(a,e)},onFocus:e=>{var t,a;n.setIsOpen(!0),null===(t=(a=i.props).onFocus)||void 0===t||t.call(a,e)},onBlur:e=>{var t,a;n.setIsOpen(!1),null===(t=(a=i.props).onBlur)||void 0===t||t.call(a,e)}}):(0,r.jsx)("span",{ref:n.triggerRef,onMouseEnter:()=>n.setIsOpen(!0),children:t})},m=e=>{let{children:t,className:a="",side:d="top"}=e,c=s.useContext(l);if(!c)throw Error("TooltipContent must be used within a Tooltip");let[x,m]=s.useState({top:0,left:0});if(s.useEffect(()=>{if(c.isOpen&&c.triggerRef.current){let e=c.triggerRef.current.getBoundingClientRect(),t=0,a=0;switch(d){case"top":t=e.top-8,a=e.left+e.width/2;break;case"bottom":t=e.bottom+8,a=e.left+e.width/2;break;case"left":t=e.top+e.height/2,a=e.left-8;break;case"right":t=e.top+e.height/2,a=e.right+8}m({top:t,left:a})}},[c.isOpen,d]),!c.isOpen)return null;let g={opacity:0,scale:.9},u="-50%",h="-100%";"bottom"===d&&(h="0%"),"left"===d&&(u="-100%",h="-50%"),"right"===d&&(u="0%",h="-50%");let p=(0,r.jsx)(i.N,{children:(0,r.jsx)(o.P.div,{initial:g,animate:{opacity:1,scale:1},exit:g,transition:{duration:.15},className:"fixed z-50 overflow-hidden rounded-md bg-white dark:bg-zinc-900 px-3 py-1.5 text-xs text-zinc-950 dark:text-zinc-50 shadow-md border border-zinc-200 dark:border-zinc-800 animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 ".concat(a),style:{top:x.top,left:x.left,transform:"translate(".concat(u,", ").concat(h,")")},children:t})});return"undefined"==typeof document?null:(0,n.createPortal)(p,document.body)}},72309:(e,t,a)=>{a.d(t,{s:()=>r});let r=a(63543).bL},39196:(e,t,a)=>{a.d(t,{A:()=>s});var r=a(35901);let s=()=>(0,r.A)()},78831:(e,t,a)=>{a.r(t),a.d(t,{addManualSource:()=>m,connectIntegration:()=>d,disconnectIntegration:()=>x,getIntegration:()=>l,getIntegrationDailyMetrics:()=>g,getIntegrationOverview:()=>u,listIntegrations:()=>o,syncIntegration:()=>c,triggerShopifyReconciliation:()=>h,verifyIntegrationIntegrity:()=>p});var r=a(89664);let s=a(2818).env.NEXT_PUBLIC_API_URL||"http://localhost:8000",n=async()=>{let e=r.auth.currentUser;if(!e)throw Error("User not authenticated");return await e.getIdToken()},i=e=>{if(!e)throw Error("Missing Company ID. Please select a company first.");if("null"===e||"undefined"===e)throw Error("Invalid Company ID format. Session may be corrupted.");return e},o=async e=>{try{let t=i(e),a=await n(),r=await fetch("".concat(s,"/api/v1/integrations/"),{headers:{Authorization:"Bearer ".concat(a),"X-Company-ID":t}});if(!r.ok){let e=await r.json().catch(()=>({}));throw Error(e.detail||"Failed to fetch integrations: ".concat(r.status))}return r.json()}catch(t){throw console.error("[API:listIntegrations] Failure:",{url:"".concat(s,"/api/v1/integrations/"),companyId:e,error:t.message}),t}},l=async(e,t)=>{try{let a=i(e),r=await n(),o=await fetch("".concat(s,"/api/v1/integrations/").concat(t),{headers:{Authorization:"Bearer ".concat(r),"X-Company-ID":a}});if(!o.ok){let e=await o.json().catch(()=>({}));throw Error(e.detail||"Failed to fetch integration: ".concat(o.status))}return o.json()}catch(a){throw console.error("[API:getIntegration] Failure:",{id:t,companyId:e,error:a.message}),a}},d=async(e,t)=>{let a=await n(),r=await fetch("".concat(s,"/api/v1/integrations/connect/").concat(t),{method:"POST",headers:{Authorization:"Bearer ".concat(a),"X-Company-ID":e}});if(!r.ok)throw Error("Failed to connect integration");return r.json()},c=async function(e,t){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=await n(),i=new URL("".concat(s,"/api/v1/integrations/sync/").concat(t));a&&i.searchParams.append("delta","true");let o=await fetch(i.toString(),{method:"POST",headers:{Authorization:"Bearer ".concat(r),"X-Company-ID":e}});if(!o.ok)throw Error("Failed to trigger sync");return o.json()},x=async(e,t)=>{let a=await n(),r=await fetch("".concat(s,"/api/v1/integrations/disconnect/").concat(t),{method:"POST",headers:{Authorization:"Bearer ".concat(a),"X-Company-ID":e}});if(!r.ok)throw Error("Failed to disconnect integration");return r.json()},m=async(e,t,a)=>{let r=await n(),i=await fetch("".concat(s,"/api/v1/integrations/add-manual-source"),{method:"POST",headers:{Authorization:"Bearer ".concat(r),"Content-Type":"application/json","X-Company-ID":e},body:JSON.stringify({slug:t,category:a})});if(!i.ok)throw Error("Failed to add manual source");return i.json()},g=async function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:30,r=await n(),i=await fetch("".concat(s,"/api/v1/analytics/daily/").concat(t,"?days=").concat(a),{headers:{Authorization:"Bearer ".concat(r),"X-Company-ID":e}});if(!i.ok)throw Error("Failed to fetch daily metrics");return i.json()},u=async(e,t)=>{let a=await n(),r=await fetch("".concat(s,"/api/v1/analytics/overview/").concat(t),{headers:{Authorization:"Bearer ".concat(a),"X-Company-ID":e}});if(!r.ok)throw Error("Failed to fetch overview metrics");return r.json()},h=async(e,t)=>{let a=await n(),r=await fetch("".concat(s,"/api/v1/integrations/shopify/integrations/").concat(t,"/reconcile"),{method:"POST",headers:{Authorization:"Bearer ".concat(a),"X-Company-ID":e}});if(!r.ok)throw Error((await r.json().catch(()=>({detail:"Failed to trigger reconciliation"}))).detail||"Failed to trigger reconciliation")},p=async(e,t)=>{let a=await n(),r=await fetch("".concat(s,"/api/v1/integrations/verify-integrity/").concat(t),{method:"POST",headers:{Authorization:"Bearer ".concat(a),"X-Company-ID":e}});if(!r.ok)throw Error((await r.json().catch(()=>({detail:"Failed to verify integrity"}))).detail||"Failed to verify integrity");return r.json()}},13001:(e,t,a)=>{a.d(t,{M:()=>n});var r=a(89664);let s=a(2818).env.NEXT_PUBLIC_API_URL||"http://localhost:8000",n=async()=>{let e=r.auth.currentUser;if(!e)throw Error("User not authenticated");let t=await e.getIdToken(),a=await fetch("".concat(s,"/api/v1/onboarding/sync"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}});if(!a.ok){let e=await a.text();throw Error("Failed to sync onboarding state: ".concat(a.status," ").concat(e))}}},29602:(e,t,a)=>{a.d(t,{Pf:()=>l,cn:()=>i,fw:()=>d,n4:()=>c,sY:()=>o});var r=a(43463),s=a(69795),n=a(80361);function i(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,s.QP)((0,r.$)(t))}function o(e){return e instanceof Date?e:new Date("number"==typeof e?e:"string"!=typeof e||e.endsWith("Z")||/[+\-]\d{2}:?\d{2}$/.test(e)?e:e+"Z")}function l(e){let t=o(e);return new Intl.DateTimeFormat("en-IN",{timeZone:"Asia/Kolkata",day:"numeric",month:"short",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).format(t)}function d(e){let t=o(e);return(0,n.B)(t,{addSuffix:!0}).replace(" seconds","s").replace(" second","s").replace(" minutes","m").replace(" minute","m").replace(" hours","h").replace(" hour","h").replace(" days","d").replace(" day","d").replace(" months","mo").replace(" month","mo").replace(" years","y").replace(" year","y")}function c(e){if(!e)return"No Phone";let t=String(e).replace(/\D/g,"");return 12===t.length&&t.startsWith("91")?"+91 ".concat(t.slice(2,7)," ").concat(t.slice(7)):10===t.length?"+91 ".concat(t.slice(0,5)," ").concat(t.slice(5)):t.length>10?"+".concat(t):t}}}]);