(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5533],{85635:(e,t,s)=>{Promise.resolve().then(s.bind(s,54835))},54835:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>y});var a=s(95155),i=s(12115),n=s(76046),r=s(36527),c=s(82855),o=s(88424),l=s(62400),d=s(14366),m=s(35901),p=s(25739),u=s(48686);function y(){let e,t,s,y,g;let h=(0,n.useRouter)(),{state:x,updateStack:f,saveAndExit:k,saveCurrentPage:w}=(0,d.z)(),{user:v,loading:j}=(0,m.A)(),[b,N]=(0,i.useState)("shipping"),[S,A]=(0,i.useState)([]),[C,E]=(0,i.useState)(!0);(0,i.useEffect)(()=>{(async()=>{if(!j&&v)try{let e=await v.getIdToken(),t=await p.F.get("/datasources/",{headers:{Authorization:"Bearer ".concat(e)}});Array.isArray(t)?A(t):t&&Array.isArray(t.data)?A(t.data):(console.error("Unexpected datasources response format:",t),A([]))}catch(e){console.error("Failed to fetch datasources:",e),alert("Failed to load stack options. Please refresh the page or check your connection.")}finally{E(!1)}})()},[v,j]);let z=(0,i.useMemo)(()=>({shipping:S.filter(e=>"Logistics"===e.category),payments:S.filter(e=>["Payment","Payouts"].includes(e.category)),marketing:S.filter(e=>"Marketing"===e.category),analytics:S.filter(e=>["Analytics","Retention","Communication"].includes(e.category)),finance:S.filter(e=>"Accounting"===e.category)}),[S]),L=async()=>{"shipping"===b?N("payments"):"payments"===b?N("marketing"):"marketing"===b?N("analytics"):"analytics"===b?N("finance"):"finance"===b&&await T()},[_,I]=(0,i.useState)(!1),T=async()=>{if(!_){I(!0);try{v&&await w()}catch(e){console.error("Failed to save stack data:",e)}finally{h.push("/onboarding/finish")}}};(0,i.useEffect)(()=>{let e=e=>{e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement||"Enter"!==e.key||(e.preventDefault(),L())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[b]);let M=e=>{if(!e||0===e.length)return(0,a.jsx)("p",{className:"text-sm text-zinc-400 italic",children:"None selected"});let t=S.filter(t=>e.includes(t.id));return(0,a.jsx)("div",{className:"flex flex-wrap gap-2 mt-1",children:t.map(e=>{var t;let s=null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes("not applicable");return(0,a.jsxs)("div",{className:"inline-flex items-center gap-2 bg-white border border-zinc-200 shadow-sm rounded-lg px-2.5 py-1",children:[s?(0,a.jsx)("div",{className:"w-4 h-4 rounded-full border border-zinc-200 flex items-center justify-center",children:(0,a.jsx)(r.A,{size:10,className:"text-zinc-400",strokeWidth:1.5})}):e.logo_url?(0,a.jsx)("img",{src:e.logo_url,alt:"",className:"w-4 h-4 object-contain"}):(0,a.jsx)("div",{className:"w-4 h-4 rounded-full bg-zinc-100 flex items-center justify-center text-[8px] font-bold",children:e.name[0]}),(0,a.jsx)("span",{className:"text-xs font-medium text-zinc-700",children:e.display_name||e.name})]},e.id)})})},P=(e,t,s)=>{var a;let i=x.stack[e]||[],n=s.find(e=>e.id===t),r=null==n?void 0:null===(a=n.name)||void 0===a?void 0:a.toLowerCase().includes("not applicable"),c=i.find(e=>{var t;let a=s.find(t=>t.id===e);return null==a?void 0:null===(t=a.name)||void 0===t?void 0:t.toLowerCase().includes("not applicable")});f({[e]:r?i.includes(t)?[]:[t]:i.includes(t)?i.filter(e=>e!==t):i.filter(e=>e!==c).concat(t)})};return(0,a.jsx)(c.c,{title:"Your Ops Stack",subtitle:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("p",{children:"Tell us what tools you use today. We'll use this only to personalize your Integrations page later."}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-zinc-500",children:[(0,a.jsx)(u.A,{size:14,className:"text-zinc-400"}),(0,a.jsx)("span",{children:"No logins required. Update anytime."})]})]}),onNext:L,nextLabel:"finance"===b?_?"Saving...":"Complete Setup":"Continue",nextDisabled:_,showSkip:!0,onSkip:k,children:(0,a.jsxs)("div",{className:"mt-8 max-w-xl mx-auto pb-24 space-y-2",children:[(0,a.jsx)(o.x,{stepNumber:1,title:"Logistics & Returns",description:"Which tools do you use to ship orders and handle returns?",isActive:"shipping"===b,isCompleted:(e=x.stack.shipping)&&e.length>0&&"shipping"!==b,onEdit:()=>N("shipping"),summary:M(x.stack.shipping),children:(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsx)(l.I,{category:"Logistics",commonSources:z.shipping.filter(e=>e.is_common),allSources:S,selectedIds:x.stack.shipping,onToggle:e=>P("shipping",e,S),showSearch:!1,drawerVariant:"stack",priorityCategory:"Logistics"})})}),(0,a.jsx)(o.x,{stepNumber:2,title:"Payments & Settlements",description:"Which tools touch your money flow? (Gateways, Payouts, etc)",isActive:"payments"===b,isCompleted:(t=x.stack.payments)&&t.length>0&&"payments"!==b,onEdit:()=>N("payments"),summary:M(x.stack.payments),children:(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsx)(l.I,{category:"Payment",commonSources:z.payments.filter(e=>e.is_common),allSources:S,selectedIds:x.stack.payments,onToggle:e=>P("payments",e,S),showSearch:!1,drawerVariant:"stack",priorityCategory:"Payment"})})}),(0,a.jsx)(o.x,{stepNumber:3,title:"Growth & Marketing",description:"Which ad platforms do you actively spend on?",isActive:"marketing"===b,isCompleted:(s=x.stack.marketing)&&s.length>0&&"marketing"!==b,onEdit:()=>N("marketing"),summary:M(x.stack.marketing),children:(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsx)(l.I,{category:"Marketing",commonSources:z.marketing.filter(e=>e.is_common),allSources:S,selectedIds:x.stack.marketing,onToggle:e=>P("marketing",e,S),showSearch:!1,drawerVariant:"stack",priorityCategory:"Marketing"})})}),(0,a.jsx)(o.x,{stepNumber:4,title:"Analytics, CRM & Customer Ops",description:"Which tools do you use to track users and talk to customers?",isActive:"analytics"===b,isCompleted:(y=x.stack.analytics)&&y.length>0&&"analytics"!==b,onEdit:()=>N("analytics"),isLast:!1,summary:M(x.stack.analytics),children:(0,a.jsx)(l.I,{category:"Analytics, CRM & Customer Ops",commonSources:z.analytics.filter(e=>e.is_common),allSources:S,selectedIds:x.stack.analytics,onToggle:e=>P("analytics",e,S),showSearch:!1,drawerVariant:"stack",priorityCategory:"Analytics"})}),(0,a.jsx)(o.x,{stepNumber:5,title:"Accounting",description:"Optional: Connect your accounting software for profitability tracking.",isActive:"finance"===b,isCompleted:(g=x.stack.finance)&&g.length>0&&"finance"!==b,onEdit:()=>N("finance"),isLast:!0,optional:!0,summary:M(x.stack.finance),children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"bg-emerald-50/50 rounded-xl p-4 border border-emerald-100/50 mb-4",children:(0,a.jsxs)("p",{className:"text-sm text-emerald-900 leading-relaxed",children:[(0,a.jsx)("span",{className:"font-semibold",children:"Pro Tip:"})," Connecting Tally/Zoho now enables true profit calculation later."]})}),(0,a.jsx)(l.I,{category:"Accounting",commonSources:z.finance.filter(e=>e.is_common),allSources:S,selectedIds:x.stack.finance,onToggle:e=>P("finance",e,S),showSearch:!1,drawerVariant:"stack",priorityCategory:"Accounting"})]})})]})})}},48686:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(67401).A)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])}},e=>{var t=t=>e(e.s=t);e.O(0,[5563,1431,1226,24,763,5714,5901,1082,2855,7412,8441,1517,7358],()=>t(85635)),_N_E=e.O()}]);